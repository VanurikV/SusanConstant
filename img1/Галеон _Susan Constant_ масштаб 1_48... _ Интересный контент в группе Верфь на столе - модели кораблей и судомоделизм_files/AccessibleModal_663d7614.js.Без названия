define(["require","exports","OK/pms!accessibilityConfiguration","OK/a11tyHelper"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AccessibleModal=void 0;var i=t.areAccessibleModalsEnabled,o=["a[href]:not([disabled]):not([tabindex='-1'])","button:not([disabled]):not([tabindex='-1'])","textarea:not([disabled]):not([tabindex='-1'])","input[type='email']:not([disabled])","input[type='text']:not([disabled])","input[type='radio']:not([disabled])","input[type='checkbox']:not([disabled])","input[type='file']:not([disabled])","select:not([disabled])","[tabindex='0']","[role='button']","[contenteditable='true']"].join(", "),a=[],l="data-modal-name",r="modal",d=function(e){return e[e.length-1]},u=function(e){return document.querySelector("["+l+'="'+e+'"]')};var s=function(e,t){for(var i=function(e){var t=e.querySelectorAll(o);return Array.prototype.slice.call(t)}(e),a=t||i[0],l=0;l<i.length&&!(0,n.isVisible)(a);)a=i[++l];var r=d(i);for(l=i.length-1;l>0&&!(0,n.isVisible)(r);)r=i[--l];return[a,r]},c=function(){};c.prototype.activate=function(e){if(i){var t=e.getAttribute(l)||r;t&&c.registerModalByElement(e,t)}},c.prototype.deactivate=function(e){if(i){var t=e.getAttribute(l)||r;t&&c.removeModal(t)}},c.handleTab=function(e){if("Tab"===e.key){var t=a[a.length-1].borderElements,n=t[0],i=t[1],l=document.activeElement;if("-1"===l.getAttribute("tabindex")){var r=l.closest(o);null!=r&&(l=r)}e.shiftKey?l===n&&(null==i||i.focus(),e.preventDefault()):l===i&&(null==n||n.focus(),e.preventDefault())}},c.registerModal=function(e,t,n,o){if(void 0===t&&(t=!0),i)if(a.length&&d(a).modalLayerName===e)this.refreshCurrentBorders();else{var l=u(e);l&&this.registerModalByElement(l,e||r,t,n,o)}},c.getActivateFocusOnOriginalElement=function(e,t){return function(){var n,i;t?"function"==typeof t?null===(n=t()||e)||void 0===n||n.focus():null===(i=t||e)||void 0===i||i.focus():null==e||e.focus()}},c.registerModalByElement=function(e,t,n,o,l){var r;if(i){a.length||document.addEventListener("keydown",this.handleTab);var d=s(e,l),u=document.activeElement;a.push({modalLayerEl:e,modalLayerName:t,activateFocusOnOriginalElement:this.getActivateFocusOnOriginalElement(u,o),borderElements:d}),n&&(null===(r=d[0])||void 0===r||r.focus())}},c.refreshCurrentBorders=function(){if(i&&a.length){var e=d(a),t=u(e.modalLayerName);t?e.borderElements=s(t):window.OK.logging.logger.error("cant-find-last-modal","last active modal "+e.modalLayerName)}},c.removeModal=function(e){var t;if(i&&(null===(t=d(a))||void 0===t?void 0:t.modalLayerName)===e){var n=a.pop();n&&(n.activateFocusOnOriginalElement(),a.length||document.removeEventListener("keydown",c.handleTab))}},e.AccessibleModal=c}));
//# sourceMappingURL=/res/source-maps/js/app/AccessibleModal.js.map