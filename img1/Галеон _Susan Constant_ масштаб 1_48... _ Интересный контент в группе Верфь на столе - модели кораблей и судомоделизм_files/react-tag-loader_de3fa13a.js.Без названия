define(["OK/webapi","OK/react-loader"],(function(t,e){"use strict";var a={};function n(t){this.name=t.name,this.js=t.js,this.bundleName=t.bundleName,this.css=t.css,this.pts=t.pts||[],this.pms=t.pms||[],this.requireModules=t.requireModules||[],this.attrsTypes=t.attrsTypes||{}}return{putTag:function(t){var e=new n(t);return a[t.name]=e,e},loadTag:function(e){var n=this;return a[e]?Promise.resolve(a[e]):t.invoke("react/tag",{name:e}).then((function(t){return n.putTag(t)}))},loadTags:function(e){var n=this,r=[],i=[];return e.forEach((function(t){a[t]?r.push(a[t]):i.push(t)})),i.length?t.invoke("react/tags",{names:i}).then((function(t){return r.concat(t.map((function(t){return n.putTag(t)})))})):Promise.resolve(r)},createElement:function(t,a,n,r){var i=document.createElement(t.name);i.setAttribute("data-react",t.js),t.css&&i.setAttribute("data-css",t.css),r&&Object.keys(r).forEach((function(t){i.setAttribute(t,JSON.stringify(r[t]))})),i.setAttribute("data-l10n",t.pts.join(",")),i.setAttribute("data-cfg",t.pms.join(",")),i.setAttribute("data-attrs-types",JSON.stringify(t.attrsTypes)),i.setAttribute("data-module","react-loader"),i.setAttribute("data-require-modules",t.requireModules.join(",")),i.setAttribute("data-bundle-name",t.bundleName),i.classList.add("h-mod"),i.classList.add(t.bundleName);var s="";return a&&Object.keys(a).forEach((function(t){s+='<ui-part data-part-id="'+t+'">'+a[t]+"</ui-part>"})),s&&(s='<template style="display: none">'+s+"</template>",i.innerHTML=s),new Promise((function(t){var a=document.createElement("div");a.appendChild(i),require(["OK/capture"],(function(r){n&&n.appendChild(a),r.activate(a),e.onAppReady(i).then((function(){n?(n.appendChild(a.removeChild(i)),t(i)):t(a.removeChild(i)),a.remove()}))}))}))},getTag:function(e,a,n,r){var i=this,s=[this.loadTag(e)],u=[];return a&&(u=Object.keys(a)).forEach((function(e){var n=a[e];if(n.commandName){var r=n.commandName,i=n.commandParams;s.push(t.invoke(r,i))}else s.push(t.invoke(n))})),Promise.all(s).then((function(t){var e={};return u.forEach((function(a,n){e[a]=t[n+1]})),i.createElement(t[0],e,n,r)}))},deactivate:function(t){require(["OK/capture"],(function(e){e.deactivate(t)}))}}}));
//# sourceMappingURL=/res/source-maps/js/app/react-tag-loader.js.map