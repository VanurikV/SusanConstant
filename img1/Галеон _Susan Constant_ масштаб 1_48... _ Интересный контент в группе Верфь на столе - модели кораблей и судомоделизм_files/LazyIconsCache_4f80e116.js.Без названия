define(["OK/utils/vanilla"],(function(t){"use strict";var e=/^\s*<svg[^>]*>([\s\S]*)<\/svg>\s*$/;function i(t){this.name=t,this.iconName=null,this.iconSize=null,this.iconData=null,this.html="",this.node=null,this.loadingPromise=null,this.listeners=[]}return i.prototype.getIconName=function(){if(null===this.iconName){var t=this.name,e=t.lastIndexOf("/");this.iconName=-1!==e?t.substring(e+1):t}return this.iconName},i.prototype.getIconSize=function(){if(null===this.iconSize){var t=this.name,e=t.lastIndexOf("_");if(-1!==e){var i=t.substring(e+1);this.iconSize=isNaN(i)?16:parseInt(i,10)}else this.iconSize=16}return this.iconSize},i.prototype.getIconData=function(){return this.node&&!this.iconData&&(this.iconData={viewBox:this.node.getAttribute("viewBox"),content:e.exec(this.html)[1]}),this.iconData},i.prototype.getNode=function(t){if(this.node)return this.clone(t)},i.prototype.get=function(t){if(this.node)return this.clone(t);this.load()},i.prototype.clone=function(t){var e=this.node.cloneNode(!0);return t&&e.setAttribute("class",t),e},i.prototype.load=function(){var e=this;return this.loadingPromise||(this.loadingPromise=t.ajax({url:"/res/s/"+this.name+".svg",type:"GET"}).then((function(t){return t&&t.response?(e.makeNode(t.response),e.notify()):e.loadingPromise=null,e}))),this.loadingPromise},i.prototype.addListener=function(t){this.listeners.push(t)},i.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)},i.prototype.notify=function(){this.listeners.slice().forEach((function(t){t(this)}))},i.prototype.makeNode=function(t){var e=document.createElement("div");return e.innerHTML=t,this.html=t,this.node=e.removeChild(e.firstChild),this.node},i.cache={},i.getInstance=function(t){if(!t)throw new Error("Не задано имя иконки");return i.cache[t]||(i.cache[t]=new i(t)),i.cache[t]},i}));
//# sourceMappingURL=/res/source-maps/js/app/LazyIconsCache.js.map