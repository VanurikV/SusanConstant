define("OK/banners/BannerLoader",["OK/logger"],(function(e){"use strict";var t="onAdsSuccess",n="onNoAds",r="onScriptError",a={};function o(e){p(t,e)}function i(e){p(n,e)}function s(e){p(r,e)}function u(e,t){return!(!e||"function"!=typeof t)&&(a.hasOwnProperty(e)||(a[e]=[]),a[e].push(t),!0)}function c(e,t){if(e&&a.hasOwnProperty(e)){var n=a[e],r=n.indexOf(t);r>=0&&n.splice(r,1)}}function l(e,t){return function(n){n&&n.slot===e&&t.call(null,n)}}function p(t,n){if(function(t,n){e.success("new-banners",t,n)}(t,n&&n.slot?n.slot:""),a.hasOwnProperty(t))for(var r=a[t],o=0,i=r.length;o<i;o++){var s=r[o];"function"==typeof s&&s(n)}}return{requestBanner:function(t){window.MRGtag||(window.MRGtag=[],window.MRGtag.push({preventAutoLoad:!0})),require(["mrg/ads"],(function(e){window.MRGtag.push({element:t,onAdsSuccess:o,onNoAds:i,onScriptError:s})}),(function(t){!function(t){e.success("new-banners",t)}("adsLoadingFailed")}))},subscribeToEvents:function(e,t){var n=[];for(var r in t)if(t.hasOwnProperty(r)){var a=l(e,t[r]);u(r,a)&&n.push({event:r,listener:a})}return{remove:function(){for(;n.length>0;){var e=n.pop();c(e.event,e.listener)}}}},publishEvent:p}})),define("OK/banners/BannerController",["OK/banners/BannerLoader","OK/banners/StickyBannerContainer","OK/ViewportWidthObserver","OK/utils/dom","OK/logger","OK/wld"],(function(e,t,n,r,a,o){"use strict";var i="onHideBanner",s="onRefreshBanner",u="data-ad-slot",c="data-ad-query",l="data-site-zone",p="data-pass-height",h="data-pass-width",d="data-right-visibility-min-width",f="data-sticky-banner",g="data-refresh-timeout",v="data-json-params",b="h",m="w",y="_SITEID",B="t",w="a",_="g",E="lang",O="u",T="v",A="la",J="test_id",N="_SITEZONE",P="l",C="group",R="ism",S="grname",I="grdesc",D="grpic",L="act",K="_STRING",k={i:"user_id",n:"user_name",r:"days_to_birth",d:"days_birth",m:"month_birth"},M="banner-layout-container",q="__ready",H="__hidden",x=[],j=[],U=[];function V(e){return e.getAttribute(u)}function W(e){if(e){var t=U.indexOf(e);t>=0&&U.splice(t,1),clearTimeout(e)}}function G(e){e&&F(X(e.el),!0)}function Y(e){e&&F(X(e.el),!1)}function F(e,t){e&&(e.classList.toggle(q,t),e.classList.toggle(H,!t))}function Z(e){var n=Q(e);n&&t.activate(n)}function z(e){var n=Q(e);n&&t.deactivate(n)}function Q(e){return e&&e.el?r.parent(e.el,"hookBlock"):null}function X(e){return e?r.parent(e,M,5,!0):null}function $(e,t){var n=parseInt(e.getAttribute(t),10);return isNaN(n)&&(n=0),n}function ee(t,n){!function(e){var t=X(e);F(t,!1)}(t),function(e,t){var n={};n[y]=163;var r=re(e);r&&(n[N]=r);var a=function(e){if(e.getAttribute(v))return JSON.parse(e.getAttribute(v))||{};return{}}(e);(function(e,t){var n=ne("hook_Cfg_CurrentUser"),r=n.bannerTargeting||{};r.t?e[B]=r.t:r.a&&(e[w]=r.a,e[_]=r.g);n.lang&&(e[E]=n.lang);t.wu&&r.u&&(e[O]=r.u);if(t.wv&&r.v){var a=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t&&(t+="&"),t+=k[n]+"="+e[n]);return t}(r.v);a&&(e[T]=a)}})(n,a),function(e,t){var n=ne("hook_Cfg_BannerConfig");t.la&&n.lastApps&&(e[A]=n.lastApps);n.expr&&(e[J]=n.expr)}(n,a),function(e,t){var n=ne("hook_Cfg_BanData");t.sz?e[N]=t.sz:t.wsz&&n.sitezone&&(e[N]=n.sitezone);n.groupId&&(e[C]=n.groupId);n.isaMember&&(e[R]=n.isaMember)}(n,a),function(e,t){t.cow&&(e[P]="1");t.grname&&(e[S]=t.grname);t.grdesc&&(e[I]=t.grdesc);t.grpic&&(e[D]=t.grpic);t.act&&(e[L]="1");t._STRING&&(e[K]=t._STRING)}(n,a),function(e){return"true"===e.getAttribute(p)}(e)&&(n[b]=document.documentElement.clientHeight);i=e,"true"===i.getAttribute(h)&&(n[m]=function(e){var t=window.getComputedStyle(e,null),n=parseInt(t.paddingLeft,10),r=parseInt(t.paddingRight,10);return e.clientWidth-n-r}(e));var i;var s=function(e){var t=e.getAttribute(c),n={};return t.replace(/([^=]*)=([^&]*)&*/g,(function(e,t,r){n[t]=decodeURIComponent(r)})),n}(t);!function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(s,n);var l=[];for(var d in s)s.hasOwnProperty(d)&&l.push(d+"="+encodeURIComponent(s[d]));var f=a.b_count;if(f&&f>0){var g=V(t),M=te(g,0);t.setAttribute(u,M);for(var q=1;q<f;q++)l.push("q="+te(g,q))}return o.detect().then((function(){l.push("d=1")}),(function(){})).then((function(){t.setAttribute(c,l.join("&"))}))}(t,n).then((function(){e.requestBanner(n)}))}function te(e,t){return encodeURIComponent(e+"."+t+"?n="+t)}function ne(e){var t=document.getElementById(e);return t&&OK.util.parseJSON(t.innerHTML)||{}}function re(e){return e.getAttribute(l)}function ae(e){for(var t=0;t<e.length;t++){var n=e[t];n&&"function"==typeof n.remove&&n.remove()}}return{activate:function(t){var r=function(e){var t=Array.prototype.slice.call(e.getElementsByTagName("ins"));if(0===t.length)return null;return t[0]}(t);if(r){var o=V(r),c=e.subscribeToEvents(o,{onAdsSuccess:G,onHideBanner:Y});j.push(c),"true"===t.getAttribute(f)&&(c=e.subscribeToEvents(o,{onAdsSuccess:Z,onHideBanner:z}),j.push(c)),c=function(t,n){var r,a=function(e){return $(e,g)}(t);if(a<=0)return null;var o=function(o){r=function(t,n,r,a){W(r);var o=setTimeout((function(){var r=V(n);e.publishEvent(s,{el:n,slot:r}),ee(t,n)}),a);return U.push(o),o}(t,n,r,a)},i=V(n);return e.subscribeToEvents(i,{onAdsSuccess:o,onNoAds:o,onScriptError:o,onHideBanner:function(e){W(r)}})}(t,r),c&&j.push(c);var l=function(e){return $(e,d)}(t);l>0?(c=n.onToggle(l,(function(n){n?ee(t,r):function(t){t.innerHTML="";var n=t.getAttribute(u);e.publishEvent(i,{el:t,slot:n})}(r)})),x.push(c),function(e,t,n){var r=e<=window.innerWidth,o=t;n&&(o+="."+n);!function(e,t){a.success("new-banners",e,t)}(r?"activate.binv":"activate.boutv",o)}(l,o,re(t))):ee(t,r)}},deactivate:function(){ae(x),ae(j),function(e){for(var t=0;t<e.length;t++){var n=e[t];n&&clearTimeout(n)}}(U),x=[],j=[],U=[]}}})),define("OK/banners/bannerNew/utils/BannerCommon",["require","exports","OK/utils/environment","OK/cookie"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEffectiveViewportHeight=e.createLog=e.log=e.isDebug=void 0;var r=function(){};e.isDebug=t.isDebug&&"true"===n.readCookie("banners-debug"),e.log=function(){for(var t=arguments.length,n=Array(t);t--;)n[t]=arguments[t];for(var r=[],a=arguments.length;a--;)r[a]=arguments[a];if(e.isDebug){var o=["[native banner]"].concat(r,n);console.log.apply(console,o)}},e.createLog=function(t){return e.isDebug?function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=["[native banner / "+t+"]"].concat(e);console.log.apply(console,r)}:r},e.getEffectiveViewportHeight=function(){var e=window.OK.topPanelHeight();return window.innerHeight-e}})),define("OK/banners/BannerPlaceListeners",["require","exports","OK/logger","OK/banners/bannerNew/utils/BannerCommon"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.subscribeToEvents=e.onLoadError=e.onLoadSuccess=e.onScriptError=e.onNoAds=e.onAdsSuccess=e.onRequest=void 0;var r={};function a(e,t){return!(!e||"function"!=typeof t)&&(r.hasOwnProperty(e)||(r[e]=[]),r[e].push(t),!0)}function o(e,t){if(e&&r.hasOwnProperty(e)){var n=r[e],a=n.indexOf(t);a>=0&&n.splice(a,1)}}function i(e,t){return function(n){n&&n.place===e&&t.call(null,n)}}function s(e,a){if(function(e,r){!function(e,t){n.isDebug&&console.log("[BannerPlaceListeners] calling event '"+e+"', transport: '"+t.transport+"', place: '"+t.place+"', slot: "+t.slot)}(e,r);var a=r.place+"."+r.slot,o=r.transport+"."+e;t.success("banner.event",a,o)}(e,a),r.hasOwnProperty(e))for(var o=r[e],i=0,s=o.length;i<s;i++){var u=o[i];"function"==typeof u&&u(a)}}e.onRequest=function(e){s("onRequest",e)},e.onAdsSuccess=function(e){s("onAdsSuccess",e)},e.onNoAds=function(e){s("onNoAds",e)},e.onScriptError=function(e){s("onScriptError",e)},e.onLoadSuccess=function(e){s("onLoadSuccess",e)},e.onLoadError=function(e){s("onLoadError",e)},e.subscribeToEvents=function(e,t){var n=[];for(var r in t)if(t.hasOwnProperty(r)){var s=i(e,t[r]);a(r,s)&&n.push({event:r,listener:s})}return{remove:function(){for(;n.length>0;){var e=n.pop();o(e.event,e.listener)}}}}})),define("OK/banners/bannerNew/BannerPlaceListenersProxyJs",["require","exports","OK/banners/BannerPlaceListeners","OK/banners/bannerNew/utils/BannerCommon"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerPlaceListenersProxyJs=void 0;var r=(0,n.createLog)("BannerPlaceListenersProxyJs"),a=null,o=function(){this.hooksByBannerPlaces={},this.hooksByBannerPlaces={}};o.getInstance=function(){return null===a&&(a=new o),a},o.prototype.logState=function(e,t){n.isDebug&&r(e+", place: '"+t.place+"', slot: "+t.getSlot()+", keys: "+Object.keys(this.hooksByBannerPlaces))},o.prototype.addBannerView=function(e){var t=e.getPlace();t&&(this.hooksByBannerPlaces[t]=e.getContainer()),this.logState("added view",e)},o.prototype.removeBannerView=function(e){var t=e.getPlace();t&&delete this.hooksByBannerPlaces[t],this.logState("removed view",e)},o.prototype.getResponseData=function(e){var t=e.bannerPlace,n=this.hooksByBannerPlaces[t];return{transport:e.transport,place:t,slot:e.slot,el:n}},o.prototype.onRequest=function(e){(0,t.onRequest)(this.getResponseData(e))},o.prototype.onAdsSuccess=function(e){(0,t.onAdsSuccess)(this.getResponseData(e))},o.prototype.onNoAds=function(e){(0,t.onNoAds)(this.getResponseData(e))},o.prototype.onScriptError=function(e){(0,t.onScriptError)(this.getResponseData(e))},o.prototype.onLoadSuccess=function(e){(0,t.onLoadSuccess)(this.getResponseData(e))},o.prototype.onLoadError=function(e){(0,t.onLoadError)(this.getResponseData(e))},e.BannerPlaceListenersProxyJs=o})),define("OK/banners/bannerNew/hooks/BannerNavigationDataProviderHookJs",["require","exports","OK/JsonCustomHook","OK/BanDataCfgJs"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(e){function t(t,n){e.call(this,"json_abp",n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.applyContent=function(e){n.BanDataCfgJs.getInstance().setData(e)},t}(t.JsonCustomHook);e.default=r})),define("OK/banners/bannerNew/config/ApplicationBannerCfgJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ApplicationBannerCfgJs=void 0;var t=function(e){this.discussionsTopSlot=+e.discussionsTop};t.prototype.getDiscussionsTopSlot=function(){return this.discussionsTopSlot},e.ApplicationBannerCfgJs=t})),define("OK/banners/bannerNew/config/BannerMultiloadCfgJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerMultiloadCfgJs=void 0;var t={adqEnabled:!0,maxLatency:"500",heartbeatDelay:"150",concurrency:"9999",url:"https://ad.mail.ru/adq/",adfTransportUrl:"https://ad.mail.ru/adf/"};e.BannerMultiloadCfgJs=function(e){e=Object.assign(Object.assign({},t),e),this.adqEnabled=e.adqEnabled||!1,this.maxLatency=+e.maxLatency,this.heartbeatDelay=+e.heartbeatDelay,this.concurrency=+e.concurrency,this.url=e.url,this.adfTransportUrl=e.adfTransportUrl}})),define("OK/banners/bannerNew/config/BannerRefreshPolicyCfgJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerRefreshPolicyCfgJs=void 0;var t=function(e){this.data=e};t.prototype.getTimeout=function(e){var t="timeout."+e,n=this.data.hasOwnProperty(t)?this.data[t]:null;return null!==n?n:this.data["timeout.default"]},t.prototype.getTransition=function(e){var t="transition."+e,n=this.data.hasOwnProperty(t)?this.data[t]:null;return null!==n?n:this.data["transition.default"]||!1},e.BannerRefreshPolicyCfgJs=t})),define("OK/banners/bannerNew/config/BannerCfgJs",["require","exports","OK/GwtConfig","OK/banners/bannerNew/config/ApplicationBannerCfgJs","OK/banners/bannerNew/config/BannerMultiloadCfgJs","OK/banners/bannerNew/config/BannerRefreshPolicyCfgJs"],(function(require,e,t,n,r,a){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),e.BannerCfgJs=void 0;var i=function(e){function t(){e.call(this,"BannerConfig")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setData=function(t){e.prototype.setData.call(this,t),this.lastApplications=this.data.lastApps,this.applicationBannerCfg=new n.ApplicationBannerCfgJs(this.data.applicationBannerSlots||{}),this.multiLoad=new r.BannerMultiloadCfgJs(this.data.adm||{}),this.timeoutCfg=new a.BannerRefreshPolicyCfgJs(this.data.timeouts),this.expr=this.data.expr||null,this.vhaBannerDebug=this.data.vha_debug||!1,this.discussionsRefreshEnabled=this.data.dre||!1,this.callbacksEnabled=this.data.ce||!1},t.prototype.getApplicationBannerCfg=function(){return this.applicationBannerCfg},t.getInstance=function(){return o||(o=new t),o},t.getLastApplications=function(){try{return t.getInstance().lastApplications}catch(e){return null}},t.getMultiLoad=function(){try{return t.getInstance().multiLoad}catch(e){return new r.BannerMultiloadCfgJs({})}},t.getRefreshPolicyCfg=function(){try{return t.getInstance().timeoutCfg}catch(e){return new a.BannerRefreshPolicyCfgJs({})}},t.getCurrentExperiment=function(){try{return t.getInstance().expr}catch(e){return null}},t}(t.GwtConfig);e.BannerCfgJs=i})),define("OK/banners/bannerNew/utils/BufferedCommandJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BufferedCommandJs=void 0;var t=function(e,t,r){var a=this;this.bufferingPeriod=e,this.heartbeatPeriod=t,this.bufferingTimer=new n((function(){a.heartbeatTimer.cancel(),a.doExecute()})),this.heartbeatTimer=new n((function(){a.bufferingTimer.cancel(),a.doExecute()})),this.execute=r};t.prototype.doExecute=function(){this.execute(),this.running=!1},t.prototype.destroy=function(){this.running&&(null!==this.bufferingTimer&&this.bufferingTimer.cancel(),null!==this.heartbeatTimer&&this.heartbeatTimer.cancel())},t.prototype.force=function(){this.bufferingTimer.cancel(),this.heartbeatTimer.cancel(),this.doExecute()},t.prototype.invoke=function(){this.running?this.heartbeatTimer.cancel():(this.running=!0,this.bufferingTimer.schedule(this.bufferingPeriod())),this.heartbeatTimer.schedule(this.heartbeatPeriod())},e.BufferedCommandJs=t;var n=function(e){this.callback=e};n.prototype.schedule=function(e){this.cancel(),this.timer=setTimeout(this.callback,e)},n.prototype.cancel=function(){this.timer&&(clearTimeout(this.timer),this.timer=0)}})),define("OK/banners/bannerNew/transport/BannerTransportJs",["require","exports","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/utils/BannerCommon","OK/banners/bannerNew/utils/BufferedCommandJs","OK/logger","OK/banners/bannerNew/BannerPlaceListenersProxyJs"],(function(require,e,t,n,r,a,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReqId=e.BannerTransportJs=void 0;var i=(0,n.createLog)("BannerTransportJs"),s="rb_tadq_"+Date.now(),u=1,c={},l={},p=0,h=[],d=0,f=new Map,g=new Map,v=o.BannerPlaceListenersProxyJs.getInstance(),b=null,m=function(){this.requests=new J,this.flushCommand=new r.BufferedCommandJs((function(){return t.BannerCfgJs.getMultiLoad().maxLatency}),(function(){return t.BannerCfgJs.getMultiLoad().heartbeatDelay}),this.flush.bind(this))};function y(e){return"blwrapper_"+e}function B(){return Object.getOwnPropertyNames(l).length<t.BannerCfgJs.getMultiLoad().concurrency}function w(){return t.BannerCfgJs.getInstance().callbacksEnabled}function _(e,t){i("sendJSONPRequest",e,t);var n=d+++"";t.forEach((function(e){f.set(e.id,n),g.set(e.id,e)})),function(e,t,n){var r=document.createElement("script");if(r.type="text/javascript",r.src=t+"&nn="+p,r.async=!0,r.id=y(e),r.onerror=function(t){E(e)},document.head.appendChild(r),l[e]=Date.now(),w()){i("script tag appended, requests: "+n.toString());try{n.forEach((function(e){v.onRequest(e)}))}catch(e){a.errorEx(e,"AdqBannerTransport","script_on_request")}var o=new P(r,n);r.addEventListener("load",o),r.addEventListener("error",o)}}(n,e,t)}function E(e){for(var t=0,n=f;t<n.length;t+=1){var r=n[t],a=r[0];r[1]==e&&O(a,"")}}function O(e,t){i("handleResponse",{id:e,response:t});try{var n=c[e];n&&n.handleResponse(t)}catch(e){a.errorEx(e,"BannerTransport","callback")}try{var r=f.get(e);f.delete(e),r&&function(e){try{delete l[e];var t=y(e),n=document.getElementById(t);if(null!==n&&n.parentNode&&(n.parentNode.removeChild(n),p++),B()&&h.length){var r=h.shift();_(r.url,r.reqIds)}}catch(e){throw a.errorEx(e,"BannerTransport","cleanup_"),e}}(r)}catch(e){a.errorEx(e,"BannerTransport","after_callback")}}m.prototype.flush=function(){var e=t.BannerCfgJs.getMultiLoad().url,n=[],r=this.requests.requests,o=Object.getOwnPropertyNames(r),u=[];if(o.length){o.forEach((function(e){var t=r[e];u.push(t);var o=e+"?n="+t.id;n.push("q="+encodeURIComponent(o));var i=OK.getCurrentDesktopModelId&&OK.getCurrentDesktopModelId()||"nogwt";a.success("ad",i,"js_adq."+e)})),i("flush, q",n),m.appendCookielessUserSyncParameters(this.requests.params);var c=e+"?callback="+s+"&_SITEID=163&"+n.join("&")+"&"+m.encodeParams(this.requests.params);this.requests.clear(),i("flush",c,u),this.addJSONPRequest(c,u)}},m.appendCookielessUserSyncParameters=function(e){[localStorage,sessionStorage].forEach((function(t){if(t)try{var n=t.getItem("rb_sync_id");if(n){var r=JSON.parse(n);for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])}}catch(e){i("can not get rb_sync_id from "+t,e)}}))},m.prototype.sendJSONP=function(e,t,n,r){this.requests.addRequest(t,n,r)||(this.flushCommand.force(),this.requests.addRequest(t,n,r)),this.flushCommand.invoke()},m.prototype.sendRequest=function(e,n,r){if(t.BannerCfgJs.getMultiLoad().adqEnabled){var a="nbnr"+u++;c[a]=new T(a,r);var o=new N(a,r.bannerPlace,e);this.sendJSONP(null,o,e,n)}},m.prototype.addJSONPRequest=function(e,t){B()?(i("addJSONPRequest now",e,t),_(e,t)):(i("addJSONPRequest queue",e,t),this.queueJSONPRequest(e,t))},m.prototype.queueJSONPRequest=function(e,t){h.push(new A(e,t))},m.prototype.sendClick=function(e,t){setTimeout((function(){(new Image).src=e+"?"+m.encodeParams(t)}),100)},m.encodeParams=function(e){var t=Object.getOwnPropertyNames(e);if(t.length){var n=[];return t.forEach((function(t){var r=e[t];null!=r&&n.push(t+"="+encodeURIComponent(r))})),n.join("&")}return""},m.appendParam=function(e,t,n){if(null!==n)switch(typeof n){case"string":e[t]=n;break;case"number":e[t]=n+""}return e},m.getInstance=function(){return null===b&&(b=new m),b},e.BannerTransportJs=m,window[s]=function(e){if(i("handleAdq",e),null!==e)try{var t=e.length;if(0===t)return void a.errorEx(new Error("ADQ empty array"),"BannerTransport","adq-array");for(var n=0;n<t;n++){var r=e[n];if(null!==r&&"object"==typeof r){var o=r.name;if(!o){a.errorEx(new Error("ADQ invalid 'name'"),"BannerTransport","adq-name");continue}var s=r.html;if(void 0===s){a.errorEx(new Error("ADQ invalid 'html'"),"BannerTransport","adq-html");continue}var u=g.get(o);if(g.delete(o),w())try{O(o,s),null!=u&&v.onAdsSuccess(u)}catch(e){a.errorEx(e,"AdqBannerTransport","handleResponse"),null!=u&&v.onScriptError(u)}else O(o,s)}else a.errorEx(new Error("ADQ invalid item"),"BannerTransport","adq-item")}}catch(e){a.errorEx(new Error("ADQ unexpected"),"BannerTransport","adq-unknown")}else a.errorEx(new Error("ADQ null response"),"BannerTransport","adq-callback")},setInterval((function(){try{var e=[];Object.getOwnPropertyNames(l).forEach((function(t){Date.now()-l[t]>5e3&&e.push(t)})),e.forEach((function(e){E(e)}))}catch(e){a.errorEx(e,"BannerTransport","cleanup")}}),5e3);var T=function(e,t){this.id=e,this.request=t,this.request.setCancellationListener(this)};T.prototype.handleResponse=function(e){this.request.handleResponse(e)},T.prototype.onCancel=function(){delete c[this.id]};var A=function(e,t){this.url=e,this.reqIds=t},J=function(){this.requests={},this.params={}};J.prototype.clear=function(){this.requests={},this.params={}},J.prototype.addRequest=function(e,t,n){var r=this;if(this.requests.hasOwnProperty(t))return!1;var a=Object.getOwnPropertyNames(this.params);a=a.filter((function(e){return n.hasOwnProperty(e)}));for(var o=0;o<a.length;o++){var i=a[o];if(n[i]!==this.params[i])return!1}return this.requests[t]=e,Object.getOwnPropertyNames(n).forEach((function(e){r.params[e]=n[e]})),!0};var N=function(e,t,n){this.transport="js_adq",this.id=e,this.bannerPlace=t,this.slot=n};N.prototype.setTransport=function(e){return this.transport=e,this},N.prototype.toString=function(){return"ReqId{id='"+this.id+"', bannerPlace='"+this.bannerPlace+"', slot="+this.slot+", transport='"+this.transport+"'}"},e.ReqId=N;var P=function(e,t){this.script=e,this.reqIds=t};P.prototype.handleEvent=function(e){if(i("script on '"+e.type+"' event handling, requests: "+this.reqIds.toString()),"load"===e.type)try{this.reqIds.forEach((function(e){v.onLoadSuccess(e)}))}catch(e){a.errorEx(e,"AdqBannerTransport","script_on_load")}else if("error"===e.type)try{this.reqIds.forEach((function(e){v.onLoadError(e)}))}catch(e){a.errorEx(e,"AdqBannerTransport","script_on_error")}this.script.removeEventListener("load",this),this.script.removeEventListener("error",this)}})),define("OK/banners/bannerNew/utils/BannerConstantJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerConstantJs=void 0;var t=function(){};e.BannerConstantJs=t,t.TARGETING_PARAMETER="t",t.RECOMMENDED_TARGETING_PARAMETER="tr",t.USER_AGE="a",t.USER_GENDER="g",t.PERSONAL_DATA_KEY="v",t.UNIQUE_ID_KEY="u",t.POSITION_KEY="p",t.IN_LAYER="layer",t.WITH_LAST_APPS="la",t.PERSONAL_DATA_ID_KEY="i",t.PERSONAL_DATA_NAME_KEY="n",t.PERSONAL_DATA_BIRTH_DAY_KEY="d",t.PERSONAL_DATA_BIRTH_MONTH_KEY="m",t.PERSONAL_DATA_DAYS_TO_BIRTH_KEY="r",t.PERSONAL_DATA_IS_COMPANYOWNER="cow",t.WITH_UNIQUE_ID="wu",t.WITH_PERSONAL_DATA="wv",t.VIEWPORT_HEIGHT="h",t.EXPR="test_id",t.EXPR_4246="rf4246",t.EXPR_DELAY="rfd",t.VISIBLE="visible",t.SITEZONE_PARAM="_SITEZONE",t.WITH_SITE_ZONE_BANNER_PARAM="wsz",t.SITE_ZONE_BANNER_PARAM="sz",t.SITENAME="sitename",t.WITH_DARK_THEME_PARAM="wdt",t.IS_DARK_THEME_PARAM_NAME="isDarkTheme",t.GROUP_ID_PARAM="group",t.GROUP_NAME_PARAM="grname",t.GROUP_DESCRIPTION_PARAM="grdesc",t.GROUP_AVATAR_URL_PARAM="grpic",t.IS_GROUP_ACTIVE_MEMBER_PARAM="ism",t.LANGUAGE="lang",t.APPS_BANNERS_WITH_CUSTOM_TITLE="act",t.APPS_BANNERS_APP_SHORT_NAME="_STRING",t.CONTENT_ID="content_id",t.ADF_TRANSPORT_PARAM="adf"})),define("OK/banners/bannerNew/banners/BannerProxyJs",["require","exports","OK/banners/bannerNew/utils/BannerCommon","OK/logger"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerProxyJs=void 0;var r=(0,t.createLog)("BannerProxyJs"),a=function(e){this.delegate=null,this.ops=null,this.options=e};a.prototype.init=function(e){if(null===this.ops){this.ops=[],this.ops.push(e?0:1);try{this.delegate=this.options.createDelegate(),r("delegate",this.delegate)}catch(e){return r("error",e),void n.errorEx(e,"BannerProxy","delegate_init_"+this.options.key())}for(var t=0;t<this.ops.length;t++){var a=this.ops[t];if(r("op",a),null===this.delegate)return;try{switch(a){case 0:this.delegate.init(!0);break;case 1:this.delegate.init(!1);break;case 2:this.delegate.show();break;case 3:this.delegate.hide();break;case 4:this.delegate.destroy()}}catch(e){return r("error",e),void n.errorEx(e,"BannerProxy","delegate_replay_"+a)}}}},a.prototype.show=function(){null!==this.delegate?this.delegate.show():this.ops.push(2)},a.prototype.hide=function(){null!==this.delegate?this.delegate.hide():this.ops.push(3)},a.prototype.destroy=function(){null!==this.delegate?(this.delegate.destroy(),this.delegate=null):this.ops.push(4)},e.BannerProxyJs=a})),define("OK/banners/bannerNew/data/BannerDataNull",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerDataNull=void 0;var t=function(){};e.BannerDataNull=t,t.NULL=new t})),define("OK/banners/bannerNew/data/BannerDataText",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerDataText=void 0;e.BannerDataText=function(e){this.text=e}})),define("OK/banners/bannerNew/data/BannerDataJson",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerDataJson=void 0;var t=function e(t){this.height=e.getStringNotNull(t,e.INTERNAL_HEIGHT_KEY),this.width=e.getStringNotNull(t,e.INTERNAL_WIDTH_KEY),this.clickUrl=e.getStringNotNull(t,e.INTERNAL_PIXEL_URL_KEY),this.targetUrl=e.getTargetUrl(t)};t.getStringNotNull=function(e,t){return e[t]||""},t.getTargetUrl=function(e){var n=t.getStringNotNull(e,t.INTERNAL_URL_KEY);return(n=n||t.getStringNotNull(e,t.INTERNAL_URL_1_KEY)).replace(/^https?:\/\/[^\/]+/,"")},e.BannerDataJson=t,t.INTERNAL_IMG_URL_KEY="img_file",t.INTERNAL_PIXEL_URL_KEY="click_url",t.INTERNAL_URL_KEY="url",t.INTERNAL_URL_1_KEY="url1",t.INTERNAL_HEIGHT_KEY="height",t.INTERNAL_WIDTH_KEY="width",t.INTERNAL_TITLE_KEY="title"})),define("OK/banners/bannerNew/data/BannerDataImage",["require","exports","OK/banners/bannerNew/data/BannerDataJson"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerDataImage=void 0;var n=function(e){function n(n){e.call(this,n);var r=(n.img_file||"").trim();this.url=r||null,this.title=t.BannerDataJson.getStringNotNull(n,t.BannerDataJson.INTERNAL_TITLE_KEY),this.impressionUrls=n.impression_urls}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n}(t.BannerDataJson);e.BannerDataImage=n})),define("OK/banners/bannerNew/BannerModelJs",["require","exports","OK/banners/bannerNew/utils/BannerConstantJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/data/BannerDataNull","OK/banners/bannerNew/data/BannerDataText","OK/banners/bannerNew/data/BannerDataJson","OK/CurrentUserCfg","OK/banners/bannerNew/data/BannerDataImage","OK/utils/utils"],(function(require,e,t,n,r,a,o,i,s,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RequestJs=e.BannerModelJs=void 0;var c=function(e,t,n){this.loader=n,this.slot=e,this.params=t};c.prototype.request=function(e,t){var n=new l(e,t,this.slot);return this.process(n),n},c.prototype.click=function(e){var r={r:Date.now()+""},a=i.CurrentUserCfg.getInstance().getBannerParameters()[t.BannerConstantJs.TARGETING_PARAMETER];a&&n.BannerTransportJs.appendParam(r,t.BannerConstantJs.TARGETING_PARAMETER,a),this.loader.sendClick(e,r)},c.prototype.process=function(e){null!==this.slot.getValue()?this.sendReq(e):e.handleResponse(null)},c.prototype.sendReq=function(e){this.loader.sendRequest(this.slot.getValue(),this.params.asJSON(),e)},e.BannerModelJs=c;var l=function(e,t,n){this.container=e,this.ready=t,this.slot=n,this.bannerPlace=e?e.getAttribute("data-place"):null};l.prototype.getResponse=function(){return this.response},l.prototype.cancel=function(){var e,t;null===(t=null===(e=this.cancellationListener)||void 0===e?void 0:e.onCancel)||void 0===t||t.call(e)},l.prototype.handleResponse=function(e){if(e){var t=this.tryParseJSON(e);null===t?this.response=new a.BannerDataText(e):t.hasOwnProperty(o.BannerDataJson.INTERNAL_IMG_URL_KEY)?this.response=new s.BannerDataImage(t):this.response=r.BannerDataNull.NULL}else this.response=r.BannerDataNull.NULL;this.handleBannerDataResponse(this.response)},l.prototype.handleBannerDataResponse=function(e){this.ready.handleResponse(e)},l.prototype.tryParseJSON=function(e){e=e.trim();try{return u.parseJson(e)}catch(e){return null}},l.prototype.setCancellationListener=function(e){this.cancellationListener=e},e.RequestJs=l})),define("OK/capture",[],(function(){"use strict";var e,t=document,n="okReqModule",r=/(\?|\&)cmd=([^\&]+)/,a=null,o=function(e){return Array.prototype.slice.call(e)},i=function(e){var t=e.match(r);if(t)return t[2]},s=function(e,t){if(e&&"object"==typeof e){if(e.default)return e.default;if(e[t])return e[t]}return e},u=function(e,t){window.OK.logger.success("require","moduleStartActivate",t);var r,o="OK/"+t;null!==a&&-1===a.indexOf(t)||(r=function(e,t){var r=e.getAttribute("data-activate")||"activate";return function(a){var o;"function"==typeof(a=s(a,t))?(o=new a(e.id,e),e[n]=o):o=a,o[r](e)}}(e,t),require.defined(o)?r(require(o)):require([o],r))},c=function(e,t){var r="OK/"+t;if((null===a||-1!==a.indexOf(t))&&require.defined(r)){var o,i=e.getAttribute("data-deactivate")||"deactivate",u=require(r);"function"==typeof(u=s(u,t))?(o=e[n],e[n]=null):o=u,o&&o[i]&&o[i](e)}},l=function(n,r){var a,s,l,p,h;for(a=o((n=n||t).getElementsByClassName("h-mod")),s=0;s<a.length;s+=1)(p=(l=a[s]).getAttribute("data-module"))&&(r?c(l,p):u(l,p));if(e)for(a=o(n.getElementsByTagName("a")),s=0;s<a.length;s+=1)if(h=(l=a[s]).getAttribute("href")){var d=i(h);d&&(p=e[d])&&(r?c(l,p):u(l,p))}},p=function(e){"interactive"===t.readyState||"complete"===t.readyState?l(e,!1):t.addEventListener("DOMContentLoaded",l)};return{setWhiteList:function(e){a=e},activate:p,activateDocument:function(t,n){var r,a,o,i;if(t&&t.length)for(e={},r=0;r<t.length;r+=1)o=(a=t[r].split(":"))[0],i=1===a.length?a[0]:a[1],e[o]=i;p()},deactivate:function(e){"interactive"!==t.readyState&&"complete"!==t.readyState||l(e,!0)}}})),define("OK/react-loader",["module","OK/logger","OK/capture"],(function(e,t,n){"use strict";var r=e.config().baseUrl||"/res/react",a=["REACT/vendors","REACT/core","OK/pts","OK/pms","OK/webapi","OK/css-loader","OK/LazyIconsCache"],o="app-block",i={INIT:o+":init",ACTIVATE:o+":activate",DEACTIVATE:o+":deactivate",ERROR:o+":error",REACT_ERROR:o+":react-error",LOG:o+":log",READY:o+":ready"},s=o+"-inited",u=function(){this.element=null,this.tagName="",this.appModule=null};function c(e){for(var t=(e||"").split(","),n=[],r=0,a=t.length;r<a;r++)t[r]&&n.push(t[r].trim());return n}function l(t){return require(t.modules,t.resolve,(function(n){var r=n.requireModules,a=e.config().retryRequireLoad||0,o=t.step||1,i=o<=a,s=i||e.config().alwaysUndefOnError;if(r&&s&&r.forEach((function(e){requirejs.undef(e)})),!r||!i)return h(t.tagName,t.error,function(e){var t=e.originalError||e;return{message:t.message||e.message||"",requireType:e.requireType,requireModules:e.requireModules,stack:t.stack||e.stack||""}}(n)),void t.reject(n);l(Object.assign({},t,{modules:r,step:o+1}))}))}function p(e){return r+"/"+e}function h(e,n,r){console.error(e,n,r),OK.Tracer.error(new Error('An error occurred in the "'+e+'" component'),{code:n,data:JSON.stringify(r)});var a=r;"object"==typeof r&&(a=Object.keys(r).map((function(e){var t=r[e];return e+"="+("string"==typeof t?t:JSON.stringify(t))})).join("\n")),t.clob("react-error",a,e,n)}function d(){return Math.floor(performance.now())}function f(e){return e<10?"0":e>5e3?"5000":(Math.floor(e)+"").split("").map((function(e,t){return t?"0":e})).join("")}return u.prototype.activate=function(e){this.element=e,this.tagName=e.tagName.toLowerCase(),this.activateStartTime=d();var t=this;if(!e)return Promise.reject(new Error("Element is not provided"));var n=e.getAttribute("data-react"),r=e.getAttribute("data-css"),o=c(e.getAttribute("data-l10n")),i=c(e.getAttribute("data-cfg")),s=c(e.getAttribute("data-require-modules"));return n?function(e,t,n,r,o,i){var s=["OK/react-loader!"+p(t)];n&&s.push("OK/css-loader!"+p(n));r.length>0&&s.push("OK/pts!"+r.join(","));o.forEach((function(e){s.push("OK/pms!"+e)}));var u=a.concat(i||[]);return new Promise((function(t,n){l({tagName:e,reject:n,modules:u,error:"react-loading-libs-error",resolve:function(){l({tagName:e,reject:n,modules:s,error:"react-loading-dependencies-error",resolve:t})}})}))}(t.tagName,n,r,o,i,s).then((function(e){try{return t.appModule=e,t.render()}catch(e){throw h(t.tagName,"react-loader-render-func-error",{message:e.message,stack:e.stack}),e}})):Promise.reject(new Error("Module path not valid"))},u.prototype.deactivate=function(){this.appModule&&this.appModule.tags[this.tagName].destroy(this.element)},u.prototype.render=function(){var e=this.element,r=function(e){var t={};if(e.hasAttributes())for(var n=e.attributes,r=n.length-1;r>=0;r--)t[n[r].name]=n[r].value;return t}(e),a=function(e){var t,n,r,a={},o=[],i=[];for(Array.from(e.childNodes).forEach((function(t){if(1===t.nodeType){var n,r=[],a=t.tagName.toLowerCase();"template"===a?(r=Array.from(((n=t).content||n).children||[]),i.push(t)):r="ui-part"===a?[t]:Array.from(function(e){return e.getElementsByTagName("ui-part")}(e)),o=o.concat(r)}})),n=o.length-1;n>=0;n--)"ui-part"===(t=o[n]).tagName.toLowerCase()&&(r=t.innerHTML)&&(a[t.getAttribute("data-part-id")]=r);return i.forEach((function(t){e.removeChild(t)})),a}(e),o=this.tagName;!function(e){var t=Array.from(e.getElementsByTagName("span")),n=require("OK/LazyIconsCache");t.forEach((function(e){if(e.hasChildNodes()&&"svg"===e.firstChild.tagName){var t=e.getAttribute("data-icon-name");if(t){var r=n.getInstance(t);r.html||r.makeNode(e.innerHTML)}}}))}(e),e.addEventListener(i.INIT,(function(t){Object.assign(e,t.detail),e.setAttribute(s,"true"),e.dispatchEvent(new CustomEvent(i.READY,{bubbles:!1,cancelable:!1}))})),e.addEventListener(i.ACTIVATE,(function(e){n.activate(e.detail.element)})),e.addEventListener(i.DEACTIVATE,(function(e){var t=e.detail.element;n.deactivateOnlyElement?n.deactivateOnlyElement(t):n.deactivate(t)})),e.addEventListener(i.ERROR,(function(e){console.error(o,e.detail),t.error(o,e.detail)})),e.addEventListener(i.REACT_ERROR,(function(e){h(o,e.detail.code,e.detail.data)})),e.addEventListener(i.LOG,(function(e){t[e.detail.type].apply(t,e.detail.params||[])}));var u=this.appModule.tags[o];try{t.success("react-render-try",o,f(d()-this.activateStartTime)),u.render({tagName:o,attrs:r,parts:a,node:e}),t.success("react-render-success",o,f(d()-this.activateStartTime))}catch(e){h(o,"react-first-render-error",{message:e.message,stack:e.stack})}},u.onAppReady=function(e){return new Promise((function(t){e.getAttribute(s)?t(e):e.addEventListener(i.READY,(function(){t(e)}))}))},u.load=function(e,t,n){if(!document.head&&!document.body)throw new Error("DOM must be loaded");t([e],n,(function(e){n.error&&n.error(e)}))},u})),define("OK/react-tag-loader",["OK/webapi","OK/react-loader"],(function(e,t){"use strict";var n={};function r(e){this.name=e.name,this.js=e.js,this.bundleName=e.bundleName,this.css=e.css,this.pts=e.pts||[],this.pms=e.pms||[],this.requireModules=e.requireModules||[],this.attrsTypes=e.attrsTypes||{}}return{putTag:function(e){var t=new r(e);return n[e.name]=t,t},loadTag:function(t){var r=this;return n[t]?Promise.resolve(n[t]):e.invoke("react/tag",{name:t}).then((function(e){return r.putTag(e)}))},loadTags:function(t){var r=this,a=[],o=[];return t.forEach((function(e){n[e]?a.push(n[e]):o.push(e)})),o.length?e.invoke("react/tags",{names:o}).then((function(e){return a.concat(e.map((function(e){return r.putTag(e)})))})):Promise.resolve(a)},createElement:function(e,n,r,a){var o=document.createElement(e.name);o.setAttribute("data-react",e.js),e.css&&o.setAttribute("data-css",e.css),a&&Object.keys(a).forEach((function(e){o.setAttribute(e,JSON.stringify(a[e]))})),o.setAttribute("data-l10n",e.pts.join(",")),o.setAttribute("data-cfg",e.pms.join(",")),o.setAttribute("data-attrs-types",JSON.stringify(e.attrsTypes)),o.setAttribute("data-module","react-loader"),o.setAttribute("data-require-modules",e.requireModules.join(",")),o.setAttribute("data-bundle-name",e.bundleName),o.classList.add("h-mod"),o.classList.add(e.bundleName);var i="";return n&&Object.keys(n).forEach((function(e){i+='<ui-part data-part-id="'+e+'">'+n[e]+"</ui-part>"})),i&&(i='<template style="display: none">'+i+"</template>",o.innerHTML=i),new Promise((function(e){var n=document.createElement("div");n.appendChild(o),require(["OK/capture"],(function(a){r&&r.appendChild(n),a.activate(n),t.onAppReady(o).then((function(){r?(r.appendChild(n.removeChild(o)),e(o)):e(n.removeChild(o)),n.remove()}))}))}))},getTag:function(t,n,r,a){var o=this,i=[this.loadTag(t)],s=[];return n&&(s=Object.keys(n)).forEach((function(t){var r=n[t];if(r.commandName){var a=r.commandName,o=r.commandParams;i.push(e.invoke(a,o))}else i.push(e.invoke(r))})),Promise.all(i).then((function(e){var t={};return s.forEach((function(n,r){t[n]=e[r+1]})),o.createElement(e[0],t,r,a)}))},deactivate:function(e){require(["OK/capture"],(function(t){t.deactivate(e)}))}}})),define("OK/ThemeEventBuses",["require","exports","OK/EventBus"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.THEME_CHANGE=e.ThemeEventBusesPrefix=void 0,e.ThemeEventBusesPrefix="ui.theme";var n=t.EventBus.factory(e.ThemeEventBusesPrefix);e.THEME_CHANGE=n("change")})),define("OK/ThemeEnum",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Theme=void 0,function(e){e.AUTO="auto",e.DARK="dark",e.LIGHT="light"}(e.Theme||(e.Theme={}))})),define("OK/theme",["require","exports","OK/webapi","OK/utils/vanilla","OK/react-tag-loader","OK/ThemeEventBuses","OK/ThemeEnum"],(function(require,e,t,n,r,a,o){"use strict";var i=this;Object.defineProperty(e,"__esModule",{value:!0}),e.changeTheme=e.getThemeModifier=e.getClientCurrentTheme=e.isDarkSystemTheme=e.browserCanUseSystemTheme=e.browserCanUseCssVariables=e.ThemeSettingBlockUpdateError=e.ThemeSettingSaveError=e.IncompatibleBrowserError=e.ThemeChangeError=e.Theme=void 0,Object.defineProperty(e,"Theme",{enumerable:!0,get:function(){return o.Theme}});var s=function(e){function t(){e.apply(this,arguments),this.name="ThemeChangeError"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error);e.ThemeChangeError=s;var u=function(e){function t(){e.apply(this,arguments),this.message="Browser version does not support theme change"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(s);e.IncompatibleBrowserError=u;var c=function(e){function t(){e.apply(this,arguments),this.message="Failed to save user theme settings on server"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(s);e.ThemeSettingSaveError=c;var l=function(e){function t(){e.apply(this,arguments),this.message="Failed to update block containing theme setting"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(s);e.ThemeSettingBlockUpdateError=l;var p,h="ToolbarUserDropdown",d="UserConfigMRB",f="UserAppearanceSettings",g="__ui-theme_dark",v="__ui-theme_light",b=document.documentElement;e.browserCanUseCssVariables=function(){var e=window.CSS&&window.CSS.supports.bind(window.CSS)||window.supportsCSS;return!!e&&e("color","var(--primary)")};e.browserCanUseSystemTheme=function(){return void 0!==window.matchMedia&&window.matchMedia("(prefers-color-scheme)").matches};e.isDarkSystemTheme=function(){return!(!(0,e.browserCanUseSystemTheme)()||!window.matchMedia("(prefers-color-scheme: dark)").matches)};e.getClientCurrentTheme=function(){return b.classList.contains(g)?o.Theme.DARK:b.classList.contains(v)?o.Theme.LIGHT:o.Theme.AUTO};e.getThemeModifier=function(e){return e===o.Theme.DARK?g:e===o.Theme.LIGHT?v:""};var m=function(n){return new Promise((function(s,l){if(!(0,e.browserCanUseCssVariables)()&&n!==o.Theme.LIGHT||!(0,e.browserCanUseSystemTheme)()&&n===o.Theme.AUTO){var h=document.getElementById("hook_Block_PopLayer");if(!h)return;return r.getTag("theme-change-impossibility-popup",null,h).then((function(e){return e.open(n)})).then((function(){return l(new u)}))}return function(t){var n=(0,e.getThemeModifier)(t);b.classList.remove(g),b.classList.remove(v),n&&b.classList.add(n)}(n),function(e){var n=p;return p=e,t.invoke("theme/update",{theme:e}).then((function(t){return t&&a.THEME_CHANGE.emit({oldValue:n||o.Theme.LIGHT,newValue:e},i||{}),t})).catch((function(){throw new c}))}(n).then((function(){return s()}))}))};e.changeTheme=function(t,r){return[o.Theme.AUTO,o.Theme.LIGHT,o.Theme.DARK].includes(t)&&t!==(0,e.getClientCurrentTheme)()?m(t).then((function(){!function(e){Promise.all([h,d,f].map((function(t){return n.ajax({url:"/dk?cmd="+t}).then((function(t){var r=function(){return t&&n.updateBlockModelCallback(t)};e?setTimeout(r,e):r()}))}))).catch((function(){throw new l}))}(r)})).catch((function(e){return window.OK.logging.info(e.name+": "+e.message)})):Promise.resolve()}})),define("OK/banners/bannerNew/config/BannerParamsJs",["require","exports","OK/banners/bannerNew/utils/BannerConstantJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/utils/BannerCommon","OK/CurrentUserCfg","OK/utils/dom","OK/theme"],(function(require,e,t,n,r,a,o,i,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerParamsJs=void 0;var u={};u[t.BannerConstantJs.PERSONAL_DATA_ID_KEY]="user_id",u[t.BannerConstantJs.PERSONAL_DATA_NAME_KEY]="user_name",u[t.BannerConstantJs.PERSONAL_DATA_DAYS_TO_BIRTH_KEY]="days_to_birth",u[t.BannerConstantJs.PERSONAL_DATA_BIRTH_DAY_KEY]="days_birth",u[t.BannerConstantJs.PERSONAL_DATA_BIRTH_MONTH_KEY]="month_birth";var c=function(e,t,n){this.withViewportHeight=!1,this.considerCompactFooter=!1,this.callbacksEnabled=!1,this.withDarkThemeParam=!1,this.withUniqueId=e,this.withPersonalData=t,this.withLastApps=n};c.prototype.asJSON=function(){var e,u={},l=o.CurrentUserCfg.getInstance();if(null!==l){var p=l.getBannerParameters()||{},h=p[t.BannerConstantJs.TARGETING_PARAMETER];if(h)n.BannerTransportJs.appendParam(u,t.BannerConstantJs.TARGETING_PARAMETER,h);else{var d=p[t.BannerConstantJs.USER_AGE];d&&(n.BannerTransportJs.appendParam(u,t.BannerConstantJs.USER_AGE,d),n.BannerTransportJs.appendParam(u,t.BannerConstantJs.USER_GENDER,p[t.BannerConstantJs.USER_GENDER]))}var f=p[t.BannerConstantJs.UNIQUE_ID_KEY];this.withUniqueId&&null!==f&&n.BannerTransportJs.appendParam(u,t.BannerConstantJs.UNIQUE_ID_KEY,f);var g=c.getPersonalData(p);this.withPersonalData&&null!==g&&n.BannerTransportJs.appendParam(u,t.BannerConstantJs.PERSONAL_DATA_KEY,g);var v=l.getLanguage();v&&n.BannerTransportJs.appendParam(u,t.BannerConstantJs.LANGUAGE,v)}if(this.withLastApps){var b=r.BannerCfgJs.getLastApplications();null!==b&&(u[t.BannerConstantJs.WITH_LAST_APPS]=b)}if(this.withViewportHeight){var m=(0,a.getEffectiveViewportHeight)();this.considerCompactFooter&&(m-=(e=i.firstByClass(document.body,"compact-footer"))?e.offsetHeight:0),u[t.BannerConstantJs.VIEWPORT_HEIGHT]=m+""}var y=r.BannerCfgJs.getCurrentExperiment();if(y&&(u[t.BannerConstantJs.EXPR]=y),this.isWithDarkThemeParam()){var B=(0,s.getClientCurrentTheme)(),w=!1;B===s.Theme.DARK?w=!0:B===s.Theme.AUTO&&(w=this.isDarkThemeSelectedInBrowser()),w&&(u[t.BannerConstantJs.IS_DARK_THEME_PARAM_NAME]="1")}return u},c.prototype.isDarkThemeSelectedInBrowser=function(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches},c.prototype.setWithViewportHeight=function(e){this.withViewportHeight=e},c.prototype.setConsiderCompactFooter=function(){this.considerCompactFooter=!0},c.prototype.isCallbacksEnabled=function(){return this.callbacksEnabled},c.prototype.setCallbacksEnabled=function(e){this.callbacksEnabled=e},c.prototype.isWithDarkThemeParam=function(){return this.withDarkThemeParam},c.prototype.setWithDarkThemeParam=function(e){this.withDarkThemeParam=e},c.getPersonalData=function(e){var n=e[t.BannerConstantJs.PERSONAL_DATA_KEY];if(!n)return null;var r=[];return Object.getOwnPropertyNames(n).forEach((function(e){r.push(u[e]+"="+n[e])})),r.join("&")},e.BannerParamsJs=c})),define("OK/banners/bannerNew/data/BannerDataIframeNull",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerDataIframeNull=void 0;var t=function(){};e.BannerDataIframeNull=t,t.IFRAME_NULL=new t})),define("OK/banners/bannerNew/utils/JSEvaluatorJs",["require","exports"],(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JSEvaluatorJs=void 0;var JSEvaluatorJs=function(){var e=this;this.logErrorWrapper=function(t,n){e.logError(t,n)}};JSEvaluatorJs.findNearestPlace=function(e,t){for(;null!==e&&t>0;){var n=e.getAttribute(JSEvaluatorJs.JSPLACE_ATTR_NAME);if(n)return n;e=e.parentElement,t--}return null},JSEvaluatorJs.evalScript=function evalScript(text){text.replace(/(^[^<]*<!--)|(-->[^>]*$)/g,""),text&&(window.execScript?window.execScript(text):window.eval?window.eval(text):eval(text))},JSEvaluatorJs.prototype.findAndEvalScripts=function(e){var t=this,n=e.getElementsByTagName("script");n.length&&Array.from(n).forEach((function(e){var n=e.getAttribute("src");if(null!==n&&n.trim()){var r=e.parentNode;r.removeChild(e);var a=document.createElement("script");a.src=n,a.type="text/javascript";var o=e.getAttribute("onload");null!==o&&t.addOnloadScript(a,o),r.appendChild(a)}else{var i=e.innerHTML;t.evalInlineJS(e,i)}}))},JSEvaluatorJs.prototype.evalInlineJS=function(e,t){if(t)try{this.setUpEvalContext(e),JSEvaluatorJs.evalScript(t)}catch(t){this.logError(e,t)}finally{OK.logging.tearDown()}},JSEvaluatorJs.prototype.setUpEvalContext=function(e){OK.logging.setUp(OK.fn.delegate(this.logErrorWrapper,[e],this))},JSEvaluatorJs.prototype.logError=function(e,t){},JSEvaluatorJs.prototype.addOnloadScript=function(e,t){var n=this;e.onload=function(){n.evalInlineJS(e,t)}},exports.JSEvaluatorJs=JSEvaluatorJs,JSEvaluatorJs.JSPLACE_ATTR_NAME="jsplace"})),define("OK/banners/bannerNew/utils/HtmlRendererJs",["require","exports","OK/banners/bannerNew/utils/BannerCommon","OK/banners/bannerNew/utils/JSEvaluatorJs","OK/logger"],(function(require,e,t,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HtmlRendererJs=void 0;var a=new n.JSEvaluatorJs,o=((0,t.createLog)("HtmlRendererJs"),!1);a.logError=function(e,t){var a=n.JSEvaluatorJs.findNearestPlace(e,3)||"unknown",o=t.message?t.message.substr(64):"";r.trace("testing",t.stack,"jsban_"+a,o)};var i=function(){this.log=(0,t.createLog)("HtmlRendererJs")};i.prototype.setBannerPlace=function(e,t){e.setAttribute(n.JSEvaluatorJs.JSPLACE_ATTR_NAME,"p"+t)},i.prototype.setBannerHtml=function(e,t){o=!0,this.log("setBannerHtml",{el:e,html:t}),e.innerHTML=t,a.findAndEvalScripts(e),o=!1},i.isInjection=function(){return o},e.HtmlRendererJs=i})),define("OK/banners/bannerNew/data/BannerDataIframe",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerDataIframe=void 0;e.BannerDataIframe=function(e){this.id=e}})),define("OK/banners/bannerNew/BannerViewJs",["require","exports","OK/banners/bannerNew/data/BannerDataNull","OK/banners/bannerNew/data/BannerDataIframeNull","OK/banners/bannerNew/data/BannerDataImage","OK/banners/bannerNew/data/BannerDataText","OK/banners/bannerNew/utils/HtmlRendererJs","OK/DispatcherJs","OK/BanDataCfgJs","OK/wld","OK/logger","OK/banners/bannerNew/data/BannerDataIframe"],(function(require,e,t,n,r,a,o,i,s,u,c,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerViewJs=void 0;var p="nbnr_",h={},d=0,f=null;function g(){"function"==typeof window.trg_gc&&window.trg_gc()}function v(){return null===f&&(f=new o.HtmlRendererJs),f}var b=Date.now();function m(){b=Date.now()}window.addEventListener("scroll",m),document.body.addEventListener("mousemove",m);var y=!0;(0,u.detect)().catch((function(){y=!1}));var B={container:null,slot:null,adfTransport:!1,inline:!1,onRender:null,onError:null},w=function(e){this.adfTransport=!1,this.contentChangeObserver=null;var r=Object.assign(Object.assign({},B),e);this.options=r,this.container=r.container,this.uid=""+d++,this.slot=r.slot.getValue(),this.place=this.container?this.container.getAttribute("data-place"):null,this.adfTransport=r.adfTransport,this.nullBannerData=this.adfTransport?n.BannerDataIframeNull.IFRAME_NULL:t.BannerDataNull.NULL,null!==this.slot&&v().setBannerPlace(r.container,this.slot),this.heightChangeWatcher=new N(this),this.nullBannerRenderer=new E(this),this.textBannerRenderer=new O(this),this.imageBannerRenderer=new T(this),this.iframeNullBannerRenderer=new A(this),this.iframeBannerRenderer=new J(this)};w.prototype.isInline=function(){return this.options.inline},w.prototype.attach=function(e){h[this.uid]=this,this.banner=e,this.heightChangeWatcher.start(),this.createBannerDomObserver(this.container)},w.prototype.detach=function(){this.destroyBannerDomObserver(),this.heightChangeWatcher.stop(),this.renderNullBanner(),this.banner=null,h[this.uid]=null},w.prototype.isInViewport=function(e){try{if(!(Date.now()-b<4e4))return!1;if(y)return!1;if("hidden"===document.visibilityState)return!1;if(e&&window.OK.Layers.isAnyLayerOpened())return!1;var t=this.container,n=s.BanDataCfgJs.getInstance().checkInViewportThreshold,r=window.pageYOffset,a=window.innerHeight,o=t.getBoundingClientRect(),i=o.height*n,u=o.top+r,l=o.bottom+r;if(a<i)return!1;var p=a+r;return u+i<p&&u>r||l-i>r&&l<p||u<r&&l>p}catch(e){return c.errorEx(e,"BannerViewJs","isInViewport"),!1}},w.prototype.getContainer=function(){return this.container},w.prototype.getSlot=function(){return this.slot},w.prototype.getPlace=function(){return this.place},w.prototype.isAdfTransport=function(){return this.adfTransport},w.prototype.showContainer=function(){var e=this;this.container.style.display="block",this.container.style.visibility="hidden",setTimeout((function(){null!==e.container&&(e.container.style.visibility="visible")}),100)},w.prototype.hideContainer=function(){this.container.style.display="none"},w.prototype.setBannerHtml=function(e){v().setBannerHtml(this.container,e)},w.prototype.renderNullBanner=function(){var e=this.nullBannerData;e instanceof t.BannerDataNull?this.showBannerDivNull(e):e instanceof n.BannerDataIframeNull&&this.showBannerDivIframeNull(e),this.container.classList.toggle("banner_new__loaded",!0),g(),this.options.onRender&&this.options.onRender(e)},w.prototype.renderBanner=function(e){var o=!1;e instanceof t.BannerDataNull?(this.showBannerDivNull(e),o=!0):e instanceof r.BannerDataImage?this.showBannerDivImage(e):e instanceof a.BannerDataText?this.showBannerDivText(e):e instanceof n.BannerDataIframeNull?(this.showBannerDivIframeNull(e),o=!0):e instanceof l.BannerDataIframe&&this.showBannerDivIframe(e),this.container.classList.toggle("banner_new__loaded",!0),g(),this.options.onRender&&this.options.onRender(e),this.options.onError&&o&&this.options.onError(e)},w.prototype.showBannerDivNull=function(e){this.nullBannerRenderer.showBannerDiv(e)},w.prototype.showBannerDivText=function(e){this.textBannerRenderer.showBannerDiv(e)},w.prototype.showBannerDivImage=function(e){this.imageBannerRenderer.showBannerDiv(e)},w.prototype.showBannerDivIframeNull=function(e){this.iframeNullBannerRenderer.showBannerDiv(e)},w.prototype.showBannerDivIframe=function(e){this.iframeBannerRenderer.showBannerDiv(e)},w.prototype.encodeClickParam=function(){return p+this.uid},w.prototype.createBannerDomObserver=function(e){if(window.MutationObserver){var t=this.heightChangeWatcher,n=new MutationObserver((function(e){for(var n=0;n<e.length;++n){e[n].addedNodes.length>0&&t.start()}}));n.observe(e,{childList:!0}),this.contentChangeObserver=n}},w.prototype.destroyBannerDomObserver=function(){var e=this.contentChangeObserver;e&&e.disconnect()},w.prototype.removeOldIframe=function(e){for(var t=this.container.getElementsByTagName("iframe"),n=0;n<t.length;n++){var r=t.item(n);if(e!==r.id)r.parentNode.removeChild(r)}},e.BannerViewJs=w;var _=function(e){this.bannerView=e};_.prototype.showBannerDiv=function(e){};var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.showBannerDiv=function(e){this.bannerView.hideContainer(),this.bannerView.container.innerHTML=""},t}(_),O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.showBannerDiv=function(e){this.bannerView.showContainer(),this.bannerView.setBannerHtml(e.text)},t}(_),T=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.showBannerDiv=function(e){this.bannerView.showContainer(),this.bannerView.setBannerHtml(this.renderHtml(e,this.bannerView.encodeClickParam())),null!==e&&null!==e.impressionUrls&&e.impressionUrls.length&&setTimeout((function(){e.impressionUrls.forEach((function(e){(new Image).src=e}))}),10)},t.prototype.renderHtml=function(e,t){return'<div class="rb_div"><div class="rb_banner"><a href="'+e.targetUrl+'" onclick="rb_js_bannerClick(\''+t+'\');return false;"><img src="'+e.url+'" width="'+e.width+'" height="'+e.height+'" border="0" alt="'+e.title+'" title="'+e.title+'"/></a></div></div>'},t}(_),A=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.showBannerDiv=function(e){this.bannerView.removeOldIframe(""),this.bannerView.hideContainer(),this.bannerView.container.innerHTML=""},t}(_),J=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.showBannerDiv=function(e){this.bannerView.removeOldIframe(e.id),this.bannerView.showContainer()},t}(_),N=function(e){this.running=!1,this.height=0,this.count=0,this.heightChangeWatcher=0,this.bannerView=e};N.prototype.start=function(){var e=this;if(!this.running){var t=this.bannerView.container;this.count=0,this.running=!0,this.height=t.offsetHeight,this.heightChangeWatcher=setInterval((function(){var n=t.offsetHeight;e.count<15?(n>0&&n!==e.height&&(e.height=n,i.DispatcherJs.get().bannerViewStateChangedEvent.trigger()),e.count++):e.stop()}),100)}},N.prototype.stop=function(){this.running&&(clearInterval(this.heightChangeWatcher),this.running=!1)},window.rb_js_bannerClick=function(e){var t=e.slice(5),n=h[t];n&&null!==n.banner&&n.banner.handleBannerClick()}})),define("OK/banners/bannerNew/utils/DurationJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DurationJs=void 0;var t=function(){this.start=performance.now()};t.prototype.elapsedMillis=function(){return performance.now()-this.start},e.DurationJs=t})),define("OK/banners/bannerNew/banners/SimpleBannerJs",["require","exports","OK/banners/bannerNew/BannerViewJs","OK/banners/bannerNew/utils/DurationJs","OK/DispatcherJs","OK/banners/bannerNew/data/BannerDataJson","OK/logger","OK/banners/bannerNew/BannerPlaceListenersProxyJs"],(function(require,e,t,n,r,a,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NavigationTriggerJs=e.TimeoutTriggerJs=e.RefreshTriggerBaseJs=e.LoggingTriggerJs=e.SimpleBannerJs=void 0;var s=function(e){var r=this;this.callbacksEnabled=!1,this.request=null,this.visible=!1,this.inLayer=!1,this.banner=null;var a=e.view,o=e.model;this.options=e,this.model=o,a instanceof HTMLElement&&(a=new t.BannerViewJs({container:a,slot:o.slot,adfTransport:!1})),this.view=a,this.callbacksEnabled=o.params.isCallbacksEnabled(),this.durationSinceLastRefresh=new n.DurationJs,this.triggers=[],this.listener={handleResponse:function(e){r.handleResponse(e)}},this.callbacksEnabled&&i.BannerPlaceListenersProxyJs.getInstance().addBannerView(this.view)};s.prototype.setInLayer=function(e){return this.inLayer=e,this},s.prototype.isInViewport=function(){return this.view.isInViewport(!this.inLayer)},s.prototype.attachRefreshTrigger=function(e,t){e.attach(this),this.triggers.push(new u(e,t))},s.prototype.init=function(e){e?this.view.showContainer():this.view.hideContainer(),this.triggers.forEach((function(t){t.init(e)}))},s.prototype.destroy=function(){this.hide(),this.triggers.forEach((function(e){e.destroy()})),this.callbacksEnabled&&i.BannerPlaceListenersProxyJs.getInstance().removeBannerView(this.view)},s.prototype.show=function(){var e=0;try{this.visible||(this.visible=!0,this.view.attach(this),e=1,this.requestBanner(),e=2,this.triggers.forEach((function(e){e.show()})))}catch(t){throw o.errorEx(t,"SimpleBanner","show_"+e),t}},s.prototype.hide=function(){this.visible?(this.triggers.forEach((function(e){e.hide()})),this.visible=!1,this.cancelBanner(),this.view.detach()):this.view.renderNullBanner()},s.prototype.cancelBanner=function(){null!==this.request&&(this.request.cancel(),this.request=null)},s.prototype.requestBanner=function(){if(this.visible){this.cancelBanner();var e=this.view.isAdfTransport()||this.callbacksEnabled?this.view.getContainer():null;this.request=this.model.request(e,this.listener),this.durationSinceLastRefresh=new n.DurationJs}},s.prototype.getDurationSinceLastRefresh=function(){return this.durationSinceLastRefresh},s.prototype.handleResponse=function(e){this.banner=e,this.view.renderBanner(e),this.request=null,this.options.onAfterHandleResponse&&this.options.onAfterHandleResponse(e)},s.prototype.handleBannerClick=function(){if(this.banner instanceof a.BannerDataJson){var e=this.banner;this.model.click(e.clickUrl),window.navigateOnUrlFromJS(e.targetUrl)}},e.SimpleBannerJs=s;var u=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.delegate=e,this.place=t};u.prototype.init=function(e){try{this.delegate.init(e)}catch(e){this.logAndRethrow(e,"init")}},u.prototype.show=function(){try{this.delegate.show()}catch(e){this.logAndRethrow(e,"show")}},u.prototype.hide=function(){try{this.delegate.hide()}catch(e){this.logAndRethrow(e,"hide")}},u.prototype.destroy=function(){try{this.delegate.destroy()}catch(e){this.logAndRethrow(e,"destroy")}},u.prototype.attach=function(e){this.delegate.attach(e)},u.prototype.logAndRethrow=function(e,t){throw o.errorEx(e,"SimpleBanner",this.place+"-"+t),e},e.LoggingTriggerJs=u;var c=function(e){function t(){e.apply(this,arguments),this.banner=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.attach=function(e){this.banner=e},t.prototype.refresh=function(){this.banner.requestBanner()},t.prototype.getDurationSinceLastRefresh=function(){return this.banner.getDurationSinceLastRefresh()},t}(u);e.RefreshTriggerBaseJs=c;var l=function(e){function t(t){e.call(this),this.refresher=null,this.intervalProvider=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.init=function(e){},t.prototype.show=function(){var e=this;null===this.refresher&&(this.refresher=setInterval((function(){var t=e.intervalProvider.getValue();null!==t&&0!==t&&e.getDurationSinceLastRefresh().elapsedMillis()>1e3*t&&e.banner.isInViewport()&&e.refresh()}),1e3))},t.prototype.hide=function(){this.refresher&&clearInterval(this.refresher)},t.prototype.destroy=function(){},t}(c);e.TimeoutTriggerJs=l;var p=function(e){function t(t){e.call(this),this.enabledProvider=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.init=function(e){},t.prototype.show=function(){r.DispatcherJs.get().updateEvent.attach(this.onUpdate,this)},t.prototype.hide=function(){r.DispatcherJs.get().updateEvent.detach(this.onUpdate,this)},t.prototype.onUpdate=function(){this.enabledProvider.getValue()&&this.refresh()},t.prototype.destroy=function(){},t}(c);e.NavigationTriggerJs=p})),define("OK/banners/bannerNew/ValueProviderJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ValueProviderJs=void 0;var t=function(e){this.getValue=e};t.create=function(e){return new t((function(){return e}))},e.ValueProviderJs=t})),define("OK/banners/bannerNew/transport/AdfBannerTransportJs",["require","exports","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/utils/BannerCommon","OK/banners/bannerNew/transport/BannerTransportJs","OK/logger","OK/banners/bannerNew/data/BannerDataIframe","OK/banners/bannerNew/BannerPlaceListenersProxyJs"],(function(require,e,t,n,r,a,o,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AdfBannerTransportJs=void 0;var s=(0,n.createLog)("AdfBannerTransportJs"),u={},c={},l=1,p=0,h=0,d=i.BannerPlaceListenersProxyJs.getInstance(),f=null,g=function(){};g.prototype.sendRequest=function(e,n,r){if(t.BannerCfgJs.getMultiLoad().adqEnabled){var a="nbnr"+l++,o=y.create(a,e,r,n);this.execute(r.container,o)}},g.prototype.execute=function(e,n){var o=n.slot,i=(n.requestId,OK.getCurrentDesktopModelId&&OK.getCurrentDesktopModelId()||"nogwt");a.success("ad",i,"js_adf."+o);var s=""+t.BannerCfgJs.getMultiLoad().adfTransportUrl+o+"?_SITEID=163&"+r.BannerTransportJs.encodeParams(n.params);this.appendIframe(e,s,n)},g.prototype.appendIframe=function(e,n,r){var o=p+++"";c[r.requestId]=o;var i=document.createElement("iframe");i.src=n+"&nn="+h,i.width="240",i.height="400",i.setAttribute("frameborder","0"),i.setAttribute("hspace","0"),i.setAttribute("marginwidth","0"),i.setAttribute("marginheight","0"),i.setAttribute("scrolling","no"),i.id=b(o),e.appendChild(i),u[o]=Date.now();var l=t.BannerCfgJs.getInstance().callbacksEnabled;if(l){s("iframe tag appended, request: "+r.getReqId());try{d.onRequest(r.getReqId())}catch(e){a.errorEx(e,"AdfBannerTransport","iframe_on_request")}}var f=new v(i,r,l);i.addEventListener("load",f)},g.prototype.sendClick=function(e,t){setTimeout((function(){(new Image).src=e+"?"+r.BannerTransportJs.encodeParams(t)}),100)},g.getInstance=function(){return null===f&&(f=new g),f},e.AdfBannerTransportJs=g;var v=function(e,t,n){this.iframe=e,this.requestHolder=t,this.callback=new m(t),this.callbacksEnabled=n};function b(e){return"adf_blwrapper_"+e}v.prototype.handleEvent=function(e){var t=this.requestHolder.getReqId();s("iframe on '"+e.type+"' event handling, request: "+t);try{this.callbacksEnabled&&d.onLoadSuccess(t),this.callback.handleResponse(this.iframe),this.callbacksEnabled&&d.onAdsSuccess(t)}catch(e){this.callbacksEnabled&&d.onScriptError(t),a.errorEx(e,"AdfBannerTransport","iframe_on_load")}try{var n=this.requestHolder.requestId,r=c[n];delete c[n],r&&function(e){try{delete u[e];var t=b(e);null!==document.getElementById(t)&&h++}catch(e){throw a.errorEx(e,"AdfBannerTransport","cleanup_running"),e}}(r)}catch(e){a.errorEx(e,"AdfBannerTransport","cleanup")}finally{this.iframe.removeEventListener("load",this)}};var m=function(e){this.request=e.request,this.request.setCancellationListener(this)};m.prototype.handleResponse=function(e){var t=new o.BannerDataIframe(e.id);this.request.handleBannerDataResponse(t)},m.prototype.onCancel=function(){};var y=function(){this.params={}};y.create=function(e,t,n,a){var o=new y;o.slot=t,o.requestId=e,o.request=n;var i=Object.getOwnPropertyNames(a);return i.length&&i.forEach((function(e){o.params[e]=a[e]})),r.BannerTransportJs.appendCookielessUserSyncParameters(o.params),o},y.prototype.getReqId=function(){return new r.ReqId(this.requestId,this.request.bannerPlace,this.slot).setTransport("js_adf")}})),define("OK/banners/bannerNew/hooks/BaseBannerHookJs",["require","exports","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/utils/BannerConstantJs","OK/DispatcherJs","OK/banners/bannerNew/banners/BannerProxyJs","OK/banners/bannerNew/BannerModelJs","OK/BanDataCfgJs","OK/banners/bannerNew/utils/BannerCommon","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/config/BannerParamsJs","OK/banners/bannerNew/BannerViewJs","OK/wld","OK/banners/bannerNew/banners/SimpleBannerJs","OK/banners/bannerNew/ValueProviderJs","OK/logger","OK/utils/utils","OK/banners/bannerNew/transport/AdfBannerTransportJs"],(function(require,e,t,n,r,a,o,i,s,u,c,l,p,h,d,f,g,v){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HookBannerParamsJs=e.BaseBannerHookJs=void 0;var b=function(e,t){this.position=null,this.banner=null,this.visible=!0,this.params=null,this.el=t,this.hookId=t.getAttribute("data-hook-id"),this.hookType=e,this.name=this.hookId,this.log=(0,s.createLog)("BaseBannerHookJs["+this.name+"]"),this.showBannerTimeout=500};b.prototype.needCleanElement=function(){return!1},b.prototype.activate=function(){this.log("activate"),this.showBannerOnActivate()?this.showBanner():this.init()},b.prototype.init=function(){var e=this;return this.initResult||(this.initResult=(0,p.detect)().then((function(){return!0}),(function(){return!1})).then((function(t){e.params=e.readBannerParams(t),e.needCleanElement()&&(e.el.removeAttribute("data-hook-id"),e.el.removeAttribute("data-module"),e.el.removeAttribute("data-params"))})).then((function(){e.log("params",e.params)}))),this.initResult},b.prototype.showBanner=function(){var e=this;return this.init().then((function(){return e.doShowBanner()}))},b.prototype.doShowBanner=function(){var e=this;return this.clearBannerContent(),null!==this.params?new Promise((function(t,n){setTimeout((function(){try{var r=e.el;null!==r&&(e.banner=new a.BannerProxyJs({createDelegate:function(){return e.createBannerDelegate(e.params,r)},key:function(){return"banner"}}),e.banner.init(e.visible),e.banner.show(),e.log("banner",e.banner),t())}catch(t){e.log("error",t),f.errorEx(t,"BannerHook-"+e.name,"init_view_"),n(t)}}),e.showBannerTimeout)})):Promise.reject()},b.prototype.deactivate=function(){null!==this.banner&&(this.banner.destroy(),this.banner=null)},b.prototype.showBannerOnActivate=function(){return!0},b.prototype.logEmptyBanner=function(){},b.prototype.createBannerDelegate=function(e,t){var n=d.ValueProviderJs.create(e.getPosition());return this.buildInlineBanner(t,e,n,this.name)},b.prototype.buildInlineBanner=function(e,n,a,i){var s=this,c=n.isUseAdfTransport()?v.AdfBannerTransportJs.getInstance():t.BannerTransportJs.getInstance(),p=new o.BannerModelJs(a,n,c),f=new l.BannerViewJs({container:e,slot:a,adfTransport:n.isUseAdfTransport(),inline:!0,onRender:function(){r.DispatcherJs.get().bannerViewStateChangedEvent.trigger()},onError:function(){s.logEmptyBanner()}}),g=this.createBanner(f,p);g.setInLayer(n.getInLayer());var b=new d.ValueProviderJs((function(){return u.BannerCfgJs.getRefreshPolicyCfg().getTransition(i)})),m=new d.ValueProviderJs((function(){return u.BannerCfgJs.getRefreshPolicyCfg().getTimeout(i)}));return g.attachRefreshTrigger(new h.NavigationTriggerJs(b),"navi_hook"),g.attachRefreshTrigger(new h.TimeoutTriggerJs(m),"timeout_hook"),g},b.prototype.createBanner=function(e,t){return new h.SimpleBannerJs({view:e,model:t})},b.prototype.getBannerJsonParams=function(){var e=this.el.getAttribute("data-params");return null===e?null:g.parseJson(e)},b.prototype.readBannerParams=function(e){var t=this.getBannerJsonParams();if((0,s.log)("bannerParams",t),null===t)return null;var r=t[n.BannerConstantJs.WITH_UNIQUE_ID],a=t[n.BannerConstantJs.WITH_PERSONAL_DATA],o=t[n.BannerConstantJs.WITH_LAST_APPS],i=t[n.BannerConstantJs.POSITION_KEY]||this.position,c=!!t[n.BannerConstantJs.PERSONAL_DATA_IS_COMPANYOWNER],l=t[n.BannerConstantJs.WITH_SITE_ZONE_BANNER_PARAM],p=new m(r,a,o,i,c,l);if(p.setAdblockWhitelist(e),t.grname&&p.setAuxGroupParameters(t.grname,t.grdesc,t.grpic),this.visible=t.visible,this.readAdditionalParams(t,p),t[n.BannerConstantJs.APPS_BANNERS_WITH_CUSTOM_TITLE]&&p.setUseAppsCustomTitle(!0),t[n.BannerConstantJs.APPS_BANNERS_APP_SHORT_NAME]&&p.setAppShortName(t[n.BannerConstantJs.APPS_BANNERS_APP_SHORT_NAME]),p.setDelay(t[n.BannerConstantJs.EXPR_DELAY]||50),p.setInLayer(t[n.BannerConstantJs.IN_LAYER]||!1),t.passWidth){var h=this.el,d=b.getInnerWidth(h);p.setWidth(d)}t.passHeight&&p.setWithViewportHeight(!0);var f=t[n.BannerConstantJs.SITE_ZONE_BANNER_PARAM];f&&p.setSiteZone(f);var g=t[n.BannerConstantJs.SITENAME];g&&p.setSitename(g),p.contentId=t[n.BannerConstantJs.CONTENT_ID];var v=t[n.BannerConstantJs.ADF_TRANSPORT_PARAM]||!1;p.setUseAdfTransport(v);var y=u.BannerCfgJs.getInstance().callbacksEnabled;p.setCallbacksEnabled(y);var B=t[n.BannerConstantJs.WITH_DARK_THEME_PARAM]||!1;return p.setWithDarkThemeParam(B),p},b.prototype.readAdditionalParams=function(e,t){},b.prototype.clearBannerContent=function(){this.el.innerHTML=""},b.getInnerWidth=function(e){var t=window.getComputedStyle(e,null),n=parseInt(t.paddingLeft,10),r=parseInt(t.paddingRight,10);return e.clientWidth-n-r},e.BaseBannerHookJs=b;var m=function(e){function r(t,n,r,a,o,i){e.call(this,t,n,r),this.groupName=null,this.groupDescription=null,this.groupAvatarUrl=null,this.useAppsCustomTitle=!1,this.appShortName=null,this.delay=0,this.width=0,this.siteZone=null,this.sitename=null,this.adblockWhitelist=!1,this.useAdfTransport=!1,this.inv=!1,this.inLayer=!1,this.contentId=null,this.position=a,this.companyOwner=o,this.withSiteZone=i}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.setPosition=function(e){this.position=e},r.prototype.setDelay=function(e){this.delay=e},r.prototype.setInv=function(e){this.inv=e},r.prototype.getDelay=function(){return this.delay},r.prototype.setInLayer=function(e){this.inLayer=e},r.prototype.getInLayer=function(){return this.inLayer},r.prototype.setAdblockWhitelist=function(e){this.adblockWhitelist=e},r.prototype.getAdblockWhitelist=function(){return this.adblockWhitelist},r.prototype.setUseAdfTransport=function(e){this.useAdfTransport=e},r.prototype.isUseAdfTransport=function(){return this.useAdfTransport},r.prototype.getPosition=function(){return this.position},r.prototype.isCompanyOwner=function(){return this.companyOwner},r.prototype.isAdblockWhitelist=function(){return this.adblockWhitelist},r.prototype.setAuxGroupParameters=function(e,t,n){this.groupName=e,this.groupDescription=t,this.groupAvatarUrl=n},r.prototype.setUseAppsCustomTitle=function(e){this.useAppsCustomTitle=e},r.prototype.setAppShortName=function(e){this.appShortName=e},r.prototype.getWidth=function(){return this.width},r.prototype.setWidth=function(e){this.width=e},r.prototype.setSiteZone=function(e){this.siteZone=e},r.prototype.setSitename=function(e){this.sitename=e},r.prototype.asJSON=function(){var e=c.BannerParamsJs.prototype.asJSON.call(this);this.isCompanyOwner()&&t.BannerTransportJs.appendParam(e,"l","1");var r=i.BanDataCfgJs.getInstance();(0,s.log)("[banDataProvider]",r);var a=null;return this.siteZone?a=this.siteZone:this.withSiteZone&&r.sitezone&&(a=r.sitezone),null!==a&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.SITEZONE_PARAM,a),r.groupId&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.GROUP_ID_PARAM,r.groupId),r.isaMember&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.IS_GROUP_ACTIVE_MEMBER_PARAM,r.isaMember),this.groupName&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.GROUP_NAME_PARAM,this.groupName),this.groupDescription&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.GROUP_DESCRIPTION_PARAM,this.groupDescription),this.groupAvatarUrl&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.GROUP_AVATAR_URL_PARAM,this.groupAvatarUrl),this.useAppsCustomTitle&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.APPS_BANNERS_WITH_CUSTOM_TITLE,"1"),this.appShortName&&t.BannerTransportJs.appendParam(e,n.BannerConstantJs.APPS_BANNERS_APP_SHORT_NAME,this.appShortName),this.getWidth()>0&&t.BannerTransportJs.appendParam(e,"w",this.getWidth()+""),this.adblockWhitelist?t.BannerTransportJs.appendParam(e,"d","1"):this.inv&&t.BannerTransportJs.appendParam(e,"inv","1"),window.OK.isStateRedesign()&&t.BannerTransportJs.appendParam(e,"web2021","1"),this.sitename&&t.BannerTransportJs.appendParam(e,"sitename",this.sitename),this.contentId&&t.BannerTransportJs.appendParam(e,"content_id",this.contentId),e},r}(c.BannerParamsJs);e.HookBannerParamsJs=m,e.default=b})),define("OK/banners/bannerNew/hooks/AppsRecommendBannerHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/banners/bannerNew/banners/SimpleBannerJs"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AppsRecommendBannerHookJs=void 0;var r=function(e){function t(t,n){e.call(this,"BanMailRAPPS",n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createBanner=function(e,t){return new n.SimpleBannerJs({view:e,model:t,onAfterHandleResponse:function(e){var t=document.getElementById("bannerLoaderId");t&&(t.style.display="none")}})},t}(t.BaseBannerHookJs);e.AppsRecommendBannerHookJs=r,e.default=r})),define("OK/banners/bannerNew/hooks/BannerAppsHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/InterstitialAppBannerEventBuses"],(function(require,e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerAppsHookJs=void 0;var r="invisible",a=function(e){function t(t,r){var a=this;e.call(this,"BanMailRBNew",r),this.onShowBanner=function(t){if(a.preparedAd)return a.showLayer(),void(a.preparedAd=!1);var r=t.detail.slot;r&&a.params.setPosition(r),e.prototype.showBanner.call(a).catch((function(e){n.ERRORED.emit({event:"error",reason:e},null)}))},this.onPrepareAds=function(t){var r=t.detail,o=r.limit,i=r.ignorePrepared;if(a.preparedAd&&o&&!i)setTimeout((function(){n.PREPARE_REPEATED.emit({event:"prepared"},null)}),0);else{var s=t.detail.slot;s&&a.params.setPosition(s),a.preparedAd=!0,e.prototype.showBanner.call(a).then((function(){n.PREPARE.emit({event:"prepared"},null)})).catch((function(e){n.ERRORED.emit({event:"error",reason:e},null)}))}},this.onStartAds=function(e){if(a.preparedAd)return!1;a.showLayer(),n.STARTED.emit({event:"start"},null)},this.onClosedAds=function(e){a.destroyBanner(),n.CLOSED.emit({event:"close"},null)},this.onFinishAds=function(e){a.destroyBanner(),n.FINISHED.emit({event:"finish"},null)},this.logEmptyBanner=function(){n.ERRORED.emit({event:"error",reason:"banner is null"},null),a.preparedAd=!1},this.destroyBanner=function(){a.hideLayer(),a.banner.destroy(),a.banner=null},this.layer=document.querySelector(".app-interstitial-layer"),this.clearContentBeforeShow=!1,this.showBannerTimeout=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.activate=function(){e.prototype.activate.call(this),this.el.addEventListener("ShowInterstitialAppBanner",this.onShowBanner),this.el.addEventListener("PrepareInterstitialAppBanner",this.onPrepareAds),this.el.addEventListener("ad_start",this.onStartAds),this.el.addEventListener("ad_closed",this.onClosedAds),this.el.addEventListener("ad_finish",this.onFinishAds)},t.prototype.showBannerOnActivate=function(){return!1},t.prototype.clearBannerContent=function(){this.clearContentBeforeShow&&(this.el.innerHTML="")},t.prototype.showLayer=function(){this.layer.classList.contains(r)&&this.layer.classList.remove(r)},t.prototype.hideLayer=function(){this.layer.classList.contains(r)||this.layer.classList.add(r)},t.prototype.deactivate=function(){this.el.removeEventListener("ShowInterstitialAppBanner",this.onShowBanner),this.el.removeEventListener("PrepareInterstitialAppBanner",this.onPrepareAds),this.el.removeEventListener("ad_start",this.onStartAds),this.el.removeEventListener("ad_closed",this.onClosedAds),this.el.removeEventListener("ad_finish",this.onFinishAds),e.prototype.deactivate.call(this)},t}(t.BaseBannerHookJs);e.BannerAppsHookJs=a,e.default=a})),define("OK/banners/bannerNew/hooks/BannerHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerHookJs=void 0;var n=function(e){function t(t,n){e.call(this,"BanMailRBNew",n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(t.BaseBannerHookJs);e.BannerHookJs=n,e.default=n})),define("OK/banners/bannerNew/banners/ConditionalBannerJs",["require","exports","OK/DispatcherJs","OK/BanDataCfgJs","OK/logger"],(function(require,e,t,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ForthColumnCondition=e.BannerNavigationDataConditionJs=e.VisibilityConditionJs=e.ConditionalBannerJs=void 0;var a=function(e,t){this.visiblity=!1,this.effective=null,this.conditions=new Array,this.delegate=e,this.blockId=" "+t+" ",this.attachCondition(new i)};a.prototype.attachCondition=function(e){this.conditions.push(e),e.setBanner(this)},a.prototype.init=function(e){this.delegate.init(e),this.conditions.forEach((function(e){e.init()}))},a.prototype.show=function(){this.visiblity=!0,this.updateBannerState()},a.prototype.hide=function(){this.visiblity=!1,this.updateBannerState()},a.prototype.updateBannerState=function(){try{var e=!0;this.conditions.forEach((function(t){e=e&&t.isVisible()}));var t=this.visiblity&&e;null!==this.effective&&!this.effective||t?null!==this.effective&&this.effective||!t||this.delegate.show():this.delegate.hide(),this.effective=t}catch(e){throw r.errorEx(e,"Banner","upBaSt"),e}},a.prototype.destroy=function(){this.conditions.forEach((function(e){e.destroy()})),this.conditions=null,this.delegate.destroy()},e.ConditionalBannerJs=a;var o=function(){this.banner=null};o.prototype.setBanner=function(e){this.banner=e},o.prototype.getBanner=function(){return this.banner},o.prototype.updateBannerState=function(){this.banner.updateBannerState()},e.VisibilityConditionJs=o;var i=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.init=function(){t.DispatcherJs.get().updateEvent.attach(this.onUpdateEvent,this)},r.prototype.destroy=function(){t.DispatcherJs.get().updateEvent.detach(this.onUpdateEvent,this)},r.prototype.isVisible=function(){var e=n.BanDataCfgJs.getInstance().blocks;return null===e||-1===e.indexOf(this.getBanner().blockId)},r.prototype.onUpdateEvent=function(){this.updateBannerState()},r}(o);e.BannerNavigationDataConditionJs=i;var s=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.init=function(){t.DispatcherJs.get().forthColumnToggledEvent.attach(this.onForthColumnToggled,this)},n.prototype.destroy=function(){t.DispatcherJs.get().forthColumnToggledEvent.detach(this.onForthColumnToggled,this)},n.prototype.onForthColumnToggled=function(){this.updateBannerState()},n.prototype.isVisible=function(){return t.DispatcherJs.isWideLayout()},n}(o);e.ForthColumnCondition=s})),define("OK/banners/bannerNew/BannerSlot",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BannerSlot=void 0,function(e){e[e.SLOT_350=350]="SLOT_350",e[e.SLOT_4246=4246]="SLOT_4246"}(e.BannerSlot||(e.BannerSlot={}))})),define("OK/banners/bannerNew/hooks/ForthColumnBannerHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/banners/bannerNew/banners/ConditionalBannerJs","OK/banners/bannerNew/utils/BannerCommon","OK/BanDataCfgJs","OK/banners/bannerNew/BannerSlot"],(function(require,e,t,n,r,a,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ForthColumnBannerHookJs=void 0;var i=function(e){function t(t,n){(0,r.log)("ForthColumnBannerHookJs init"),e.call(this,"BanMailRB4",n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.needCleanElement=function(){return!0},t.prototype.createBannerDelegate=function(t,r){var a=e.prototype.createBannerDelegate.call(this,t,r),o=new n.ConditionalBannerJs(a,"ForthColumnTopBanner");return o.attachCondition(new n.ForthColumnCondition),o},t.prototype.readAdditionalParams=function(e,t){a.BanDataCfgJs.getInstance().inv&&!t.isAdblockWhitelist()&&(t.setWithViewportHeight(!0),t.setInv(!0),a.BanDataCfgJs.getInstance().slotInv&&t.setPosition(o.BannerSlot.SLOT_350))},t}(t.BaseBannerHookJs);e.ForthColumnBannerHookJs=i,e.default=i})),define("OK/banners/bannerNew/hooks/MediaTopicLayerContentHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/ViewportTracker","OK/webapi"],(function(require,e,t,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MediaTopicLayerContentHookJs=void 0;var a={attributes:!0,childList:!0,subtree:!0},o=function(e){function t(t,n){var o=this;e.call(this,"MediaTopicLayerContentBlock",n),this.tracking=!1,this.callbackMutation=function(){if(o.el.hasChildNodes()&&o.el.clientHeight>0){var e=o.el.parentNode,t=e.querySelector(".layer-banner-stubs");null!=t&&e.removeChild(t)}},this.viewportHandler=function(e){if(e)return o.stopTrack(),r.invoke("mediatopic/scrollToBottom",{topicId:o.topicId})},this.observer=new MutationObserver(this.callbackMutation),this.observer.observe(this.el,a)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.activate=function(){e.prototype.activate.call(this),n.add(this.el,this.viewportHandler),this.tracking=!0},t.prototype.deactivate=function(){this.observer.disconnect(),this.stopTrack(),e.prototype.deactivate.call(this)},t.prototype.readAdditionalParams=function(e,t){this.topicId=e.topicId},t.prototype.stopTrack=function(){this.tracking&&(n.remove(this.el,this.viewportHandler),this.tracking=!1)},t}(t.BaseBannerHookJs);e.MediaTopicLayerContentHookJs=o,e.default=o})),define("OK/banners/bannerNew/hooks/ViewportHeightAwareBannersHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/BanDataCfgJs","OK/banners/bannerNew/BannerSlot"],(function(require,e,t,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewportHeightAwareBannersHookJs=void 0;var a=function(e){function t(t,n){e.call(this,"VHAB",n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.needCleanElement=function(){return!0},t.prototype.readAdditionalParams=function(e,t){n.BanDataCfgJs.getInstance().inv&&!t.isAdblockWhitelist()?(t.setInv(!0),n.BanDataCfgJs.getInstance().slotInv&&t.setPosition(r.BannerSlot.SLOT_4246)):(t.setConsiderCompactFooter(),t.setWithViewportHeight(!0))},t}(t.BaseBannerHookJs);e.ViewportHeightAwareBannersHookJs=a,e.default=a})),define("OK/banners/bannerNew/discussions/DiscussionsBannerParamJs",["require","exports","OK/banners/bannerNew/config/BannerParamsJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/utils/BannerConstantJs"],(function(require,e,t,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiscussionsBannerParamJs=void 0;var a=function(e){function t(t,n,r,a){e.call(this,t,n,r),this.sitezone=a,e.prototype.setWithViewportHeight.call(this,!0)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.asJSON=function(){var t=e.prototype.asJSON.call(this);return this.sitezone&&n.BannerTransportJs.appendParam(t,r.BannerConstantJs.SITEZONE_PARAM,this.sitezone),t},t}(t.BannerParamsJs);e.DiscussionsBannerParamJs=a})),define("OK/banners/bannerNew/banners/CompositeBannerJs",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CompositeBannerJs=void 0;var t=function(){this.banners=new Array,this.defaultVisible=null,this.visible=null};t.prototype.addBanner=function(e){return this.banners.push(e),null!==this.defaultVisible&&e.init(this.defaultVisible),null!==this.visible&&(this.visible?e.show():e.hide()),this},t.prototype.init=function(e){this.defaultVisible=e,this.banners.forEach((function(t){t.init(e)}))},t.prototype.show=function(){this.banners.forEach((function(e){e.show()})),this.visible=!0},t.prototype.hide=function(){this.banners.forEach((function(e){e.hide()})),this.visible=!1},t.prototype.destroy=function(){this.banners.forEach((function(e){e.destroy()})),this.defaultVisible=null,this.visible=null},e.CompositeBannerJs=t})),define("OK/banners/bannerNew/discussions/DiscussionsBannerJs",["require","exports","OK/banners/bannerNew/ValueProviderJs","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/discussions/DiscussionsBannerParamJs","OK/banners/bannerNew/banners/CompositeBannerJs","OK/banners/bannerNew/banners/SimpleBannerJs","OK/banners/bannerNew/banners/BannerProxyJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/BannerModelJs","OK/DispatcherJs"],(function(require,e,t,n,r,a,o,i,s,u,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiscussionsBannerJs=void 0;var l=function(e){this.topBanner=e,this.topBannerSlot=new t.ValueProviderJs((function(){return n.BannerCfgJs.getInstance().getApplicationBannerCfg().getDiscussionsTopSlot()})),this.callbacksEnabled=new t.ValueProviderJs((function(){return n.BannerCfgJs.getInstance().callbacksEnabled}))};l.prototype.init=function(e){var l=this;this.banner=new i.BannerProxyJs({createDelegate:function(){var e=new r.DiscussionsBannerParamJs(!1,!0,!0,"6");e.setCallbacksEnabled(l.callbacksEnabled.getValue());var i=new u.BannerModelJs(l.topBannerSlot,e,s.BannerTransportJs.getInstance()),c=new o.SimpleBannerJs({view:l.topBanner,model:i}).setInLayer(!0);if(n.BannerCfgJs.getInstance().discussionsRefreshEnabled){var p="discussionsBanner",h=new t.ValueProviderJs((function(){return n.BannerCfgJs.getRefreshPolicyCfg().getTransition(p)})),d=new t.ValueProviderJs((function(){return n.BannerCfgJs.getRefreshPolicyCfg().getTimeout(p)}));c.attachRefreshTrigger(new o.NavigationTriggerJs(h),"navi_hook"),c.attachRefreshTrigger(new o.TimeoutTriggerJs(d),"timeout_hook")}return(new a.CompositeBannerJs).addBanner(c)},key:function(){return"disc"}}),this.banner.init(e),c.DispatcherJs.get().forthColumnToggledEvent.attach(this.onColumnToggled,this)},l.prototype.show=function(){null===this.banner&&this.init(!1),this.banner.show()},l.prototype.hide=function(){null!==this.banner&&this.banner.hide()},l.prototype.destroy=function(){null!==this.banner&&(this.banner.destroy(),this.banner=null),c.DispatcherJs.get().forthColumnToggledEvent.detach(this.onColumnToggled,this)},l.prototype.onColumnToggled=function(e){e?this.show():this.hide()},e.DiscussionsBannerJs=l})),define("b/bpo",["OK/banners/BannerController","OK/banners/BannerLoader","OK/banners/BannerPlaceListeners","OK/banners/bannerNew/BannerPlaceListenersProxyJs","OK/banners/bannerNew/hooks/BannerNavigationDataProviderHookJs","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/banners/bannerNew/hooks/AppsRecommendBannerHookJs","OK/banners/bannerNew/hooks/BannerAppsHookJs","OK/banners/bannerNew/hooks/BannerHookJs","OK/banners/bannerNew/hooks/ForthColumnBannerHookJs","OK/banners/bannerNew/hooks/MediaTopicLayerContentHookJs","OK/banners/bannerNew/hooks/ViewportHeightAwareBannersHookJs","OK/banners/bannerNew/discussions/DiscussionsBannerJs"],{});
//# sourceMappingURL=/res/source-maps/js/b/bpo.js.map